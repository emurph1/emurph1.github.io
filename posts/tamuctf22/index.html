<!doctype html><html lang=en-us data-theme>
<head>
<meta charset=utf-8>
<meta name=HandheldFriendly content="True">
<meta name=viewport content="width=device-width,initial-scale=1">
<meta name=referrer content="no-referrer-when-downgrade">
<title>TAMUctf 2022 - Emily's Personal Website!</title>
<meta name=description content="TAMUctf 2022">
<link rel=icon type=image/x-icon href=https://murphe22.com/favicon.ico>
<link rel=apple-touch-icon-precomposed href=https://murphe22.com/favicon.png>
<link rel=stylesheet href=https://murphe22.com/css/style.min.d5f59c9c7a22901a590b8b30252f1bfb21e1b9fc0867fd35e1851f498f522342.css integrity="sha256-1fWcnHoikBpZC4swJS8b+yHhufwIZ/014YUfSY9SI0I=">
<script src=https://murphe22.com/js/script.min.510c781c39dbb21b4c76d85c82e2bdf4689220adbb7cd61e49e9d293e442fb42.js type=text/javascript integrity="sha256-UQx4HDnbshtMdthcguK99GiSIK27fNYeSenSk+RC+0I="></script>
<meta property="og:title" content="TAMUctf 2022">
<meta property="og:description" content="TAMUctf 2022">
<meta property="og:type" content="article">
<meta property="og:url" content="https://murphe22.com/posts/tamuctf22/"><meta property="article:section" content="posts">
<meta name=twitter:card content="summary">
<meta name=twitter:title content="TAMUctf 2022">
<meta name=twitter:description content="TAMUctf 2022">
</head>
<body>
<a class=skip-main href=#main>Skip to main content</a>
<div class=container>
<header class=common-header>
<head>
<div class=header-top>
<h1 class=site-title>
<a href=/>Emily's Personal Website!</a>
</h1>
<ul class=social-icons>
<li>
<a href=https://www.linkedin.com/in/murphe22/ title=Linkedin rel=me>
<span class=inline-svg><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path fill="currentcolor" d="M416 32H31.9C14.3 32 0 46.5.0 64.3v383.4C0 465.5 14.3 480 31.9 480H416c17.6.0 32-14.5 32-32.3V64.3c0-17.8-14.4-32.3-32-32.3zM135.4 416H69V202.2h66.5V416zm-33.2-243c-21.3.0-38.5-17.3-38.5-38.5S80.9 96 102.2 96c21.2.0 38.5 17.3 38.5 38.5.0 21.3-17.2 38.5-38.5 38.5zm282.1 243h-66.4V312c0-24.8-.5-56.7-34.5-56.7-34.6.0-39.9 27-39.9 54.9V416h-66.4V202.2h63.7v29.2h.9c8.9-16.8 30.6-34.5 62.9-34.5 67.2.0 79.7 44.3 79.7 101.9V416z"/></svg>
</span>
</a>
</li>
<li>
<a href=https://github.com/emurph1 title=Github rel=me>
<span class=inline-svg><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><path fill="currentcolor" d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6.0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6.0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3.0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1.0-6.2-.3-40.4-.3-61.4.0.0-70 15-84.7-29.8.0.0-11.4-29.1-27.8-36.6.0.0-22.9-15.7 1.6-15.4.0.0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5.0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9.0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4.0 33.7-.3 75.4-.3 83.6.0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6.0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9.0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
</span>
</a>
</li>
<li>
<a href=https://github.com/emurph1 title=Twitter rel=me>
<span class=inline-svg><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentcolor" d="M459.37 151.716c.325 4.548.325 9.097.325 13.645.0 138.72-105.583 298.558-298.558 298.558-59.452.0-114.68-17.219-161.137-47.106 8.447.974 16.568 1.299 25.34 1.299 49.055.0 94.213-16.568 130.274-44.832-46.132-.975-84.792-31.188-98.112-72.772 6.498.974 12.995 1.624 19.818 1.624 9.421.0 18.843-1.3 27.614-3.573-48.081-9.747-84.143-51.98-84.143-102.985v-1.299c13.969 7.797 30.214 12.67 47.431 13.319-28.264-18.843-46.781-51.005-46.781-87.391.0-19.492 5.197-37.36 14.294-52.954 51.655 63.675 129.3 105.258 216.365 109.807-1.624-7.797-2.599-15.918-2.599-24.04.0-57.828 46.782-104.934 104.934-104.934 30.213.0 57.502 12.67 76.67 33.137 23.715-4.548 46.456-13.32 66.599-25.34-7.798 24.366-24.366 44.833-46.132 57.827 21.117-2.273 41.584-8.122 60.426-16.243-14.292 20.791-32.161 39.308-52.628 54.253z"/></svg>
</span>
</a>
</li>
</ul>
</div>
<nav>
<a href=https://murphe22.com/about/ title>About</a>
<a href=https://murphe22.com/posts/ title>Writeups</a>
<a href=https://murphe22.com/contact/ title>Contact</a>
<a href=https://murphe22.com/tags/ title>Tags</a>
</nav>
<script async src="https://www.googletagmanager.com/gtag/js?id=G-X2SRPQFBT4"></script>
<script>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag('js',new Date),gtag('config','G-X2SRPQFBT4')</script>
</head>
</header>
<main id=main tabindex=-1>
<article class="post h-entry">
<div class=post-header>
<header>
<h1 class="p-name post-title">TAMUctf 2022</h1>
</header>
</div>
<div class="content e-content">
<div class=paragraph>
<p><strong>Ending Rank:</strong> 1st place amongst TAMU teams and 14th overall (Total of 477 teams)</p>
</div>
<div class=paragraph>
<p>TAMUctf is a jeopardy-style cybersecurity capture the flag competition developed and hosted by Texas A&M Students. The competition has been designed to have challenges accessible to newer players as well ones that will keep more experienced players busy. So if you are just getting into cybersecurity or have been playing CTFs for a while, TAMUctf will be a great opportunity to learn new cybersecurity skills!</p>
</div>
<div class=paragraph>
<p><strong>Time:</strong> Starting at 12:00pm Friday – Closing 12:00pm Sunday</p>
</div>
<div class=paragraph>
<p>For this CTF, I only wrote writeups for the challenges I found the most interesting/wanted to make a writeup for in case I need the skills for future CTFs.</p>
</div>
<h1 id=_non_stick_disk class=sect0>Non Stick Disk</h1>
<div class=paragraph>
<p>CTF username: nightfury</p>
</div>
<div class=sect1>
<h2 id=_prompt>Prompt</h2>
<div class=sectionbody>
<div class=paragraph>
<p>We’ve established a persistence mechanism on the attached disk. Can you determine what that is?</p>
</div>
<div class=paragraph>
<p>The flag is in the standard format. You’ll know it when you see it. :)</p>
</div>
<div class=paragraph>
<p><strong>Given</strong>: non-stick-disk.zlib</p>
</div>
</div>
</div>
<div class=sect1>
<h2 id=_solve>Solve</h2>
<div class=sectionbody>
<div class=paragraph>
<p>First I had to figure out how to decompress a zlib file within a directory. I used <a href=https://unix.stackexchange.com/questions/22834/how-to-uncompress-zlib-data-in-unix>this</a> resource in order to do it and piped it into a directory. Full command:</p>
</div>
<div class=paragraph>
<p><code>zlib-flat -uncompress &lt; non-stick-disk.zlib > nonstick</code></p>
</div>
<div class=paragraph>
<p>From there, I noticed there are a TON of files in the directory, so one trick of forensics (that I now know) is to check the <code>etc/os-release</code> and then do a diff on the filesystems. From cat-ing the os-release, we see this:</p>
</div>
<div class=imageblock>
<div class=content>
<img src=../non-stick-disk/os-release.png alt="os release">
</div>
</div>
<div class=paragraph>
<p>Now came the part that took me the longest…​ finding a root filesystem that I could diff on. At first, Rohan and I were pouring through FTK Imager and Autopsy to find sus things, but came to no promising findings (even had a little red herring). After a copious amount of researching, one key google search and many clicks later got me to <a href=https://help.ubuntu.com/community/DebootstrapChroot>Debootstrap</a>. A little bit more reading on how to Debootstrap and understanding what architecture the nonstick filesystem is (there is a <code>x86_64-linux_gnu</code> directory in <code>lib</code>, which indicated amd64), we could create our own Ubuntu 20.04 Focal Fossa <a href=https://pub.nethence.com/xen/debootstrap>quick</a>! Actual command:</p>
</div>
<div class=paragraph>
<p><code>sudo debootstrap --arch amd64 focal ubuntu (directory I want it to go to) <a href=http://archive.ubuntu.com/ubuntu class=bare>http://archive.ubuntu.com/ubuntu</a></code></p>
</div>
<div class=paragraph>
<p>With my two filesystems, I could finally do a diff and see what things may be interesting to investigate…​ much better than having to search through each file (which I had already done plenty of by this point).</p>
</div>
<div class="admonitionblock note">
<table>
<tbody><tr>
<td class=icon>
<div class=title>Note</div>
</td>
<td class=content>
the nonstick directory is actually mounted on a directory called mountpoint
</td>
</tr>
</tbody></table>
</div>
<div class=paragraph>
<p>To diff the filesystems: <code>diff -qr mountpoint ubuntu > diffs.txt</code></p>
</div>
<div class=paragraph>
<p><code>-q</code> for quick so we can see ONLY the files that differ between the two filesystems<br>
<code>-r</code> for recursive</p>
</div>
<div class=paragraph>
<p>Investigating the <code>diffs.txt</code>, there is one sus line and that is <code>File mountpount/lib/x86_64-linux-gnu/security/pam_unix.so and ubuntu/lib/x86_64-linux-gnu/security/pam_unix.so differ</code>. So, I strings-d the file and saw <code>/home/addisoncrump/git/tamuctf-2022/forensics/non-stick-disk/pam_backdoor/linux-pam-1.3.1/modules/pam_unix</code> so that was pretty assuring that this was indeed the persistence mechanism.</p>
</div>
<div class=paragraph>
<p>But where is the flag? Well we have a binary so naturally, the next step is to boot it up in good ol Ghidra. I poked around for a good amount before I finally saw something that could be related to the flag and it was this little snippet:</p>
</div>
<div class=imageblock>
<div class=content>
<img src=../images/tamuctf/non-stick-disk/alternative_key.png alt=100 width=300>
</div>
</div>
<div class=paragraph>
<p>Now there is an alternative and alternative_key stored in byte arrays, so that is interesting, but how are they used? Well if we look at the following code:</p>
</div>
<div class=imageblock>
<div class=content>
<img src=../images/tamuctf/non-stick-disk/xorbytes.png alt=300 width=300>
</div>
</div>
<div class=paragraph>
<p>This indicates that each byte is xor-d with each other…​ so we can go in and grab that hex and xor them against each other.</p>
</div>
<div class=paragraph>
<p>The other thing to note here is the <code>bVar9 = 0xea</code> and <code>bVar9 = 0x8d</code>. When you xor these values, you get 'g', so we further know that this is an xor to get the flag. Using <a href=https://xor.pw/>XOR calculator</a>, we get <code>67656769675f617b6d5f7469625f6f6f746976626f5f73756f795f6669615f756f6d5f6b730000</code>, which we put into <a href=https://cyberchef.org>Cyberchef</a>. We did have to mess around a little to get the actual flag format (removing the beginning "67" and then adding a "65" at the end). Finally recipe:</p>
</div>
<div class=imageblock>
<div class=content>
<img src=../images/tamuctf/non-stick-disk/cyberchef.png alt=cyberchef>
</div>
</div>
<div class=paragraph>
<p>Flag: <code>gigem{a_bit_too_obvious_if_you_ask_me}</code></p>
</div>
<div class=paragraph>
<p>This challenge was incredibly infuriating, but really cool after solving it. Also being one of two solvers was really cool :D.</p>
</div>
<div class=imageblock>
<div class=content>
<img src=../images/tamuctf/non-stick-disk/solvers2.png alt=300 width=300>
</div>
</div>
<div class=sect2>
<h3 id=_alternatve_and_much_faster_solve>Alternatve (and much faster solve)</h3>
<div class=paragraph>
<p>After solving the challenge in the way described above, I wondered if you could solve it quicker using grep.</p>
</div>
<div class=paragraph>
<p>Turns out Addison didn’t strip symbols, so you could in fact <code>grep -r "backdoor"</code> and find the file…​. :pensive:, but at least I learned a lot in the process!</p>
</div>
</div>
</div>
</div>
<h1 id=_vanity class=sect0>Vanity</h1>
<div class=sect1>
<h2 id=_prompt_2>Prompt</h2>
<div class=sectionbody>
<div class=paragraph>
<p><a href=https://github.com/tamuctf/vanity>Read, weep, seethe, and cope.</a></p>
</div>
<div class=paragraph>
<p>Only commits you need to consider are those made by VTCAKAVSMoACE.</p>
</div>
<div class=paragraph>
<p><strong>Given:</strong> <a href=https://c.tenor.com/3BMRCVepIa8AAAAC/vanity-smurf-youre-so-vain.gif>vanity-smurf-youre-so-vain.gif</a></p>
</div>
</div>
</div>
<div class=sect1>
<h2 id=_solve_2>Solve</h2>
<div class=sectionbody>
<div class=paragraph>
<p>So at first glance, the link goes to a git repo that is completely empty. There was only one commit and zero history so that was interesting…​.</p>
</div>
<div class=paragraph>
<p>The prompt and gif associated with this challenge gave a good amount away. Now I was not very smart and got caught in an article saying you <em>couldn’t</em> mirror a git repo and it wasn’t until Rohan looked into it that I realized my grave mistake…​.</p>
</div>
<div class=paragraph>
<p>Anywho, looking at this <a href=https://sourcelevel.io/blog/how-to-properly-mirror-a-git-repository>how to properly mirror a git repository</a>, we could find the mirrored git repo.</p>
</div>
<div class=paragraph>
<p>Command: <code>git clone --mirror vanityhttps://github.com/tamuctf/</code></p>
</div>
<div class=paragraph>
<p>Then we see the following and get the flag!</p>
</div>
<div class=imageblock>
<div class=content>
<img src=../images/tamuctf/vanity.png alt=vanity>
</div>
</div>
<div class=imageblock>
<div class=content>
<img src=../images/tamuctf/vanity_flag.png alt="vanity flag">
</div>
</div>
<div class=paragraph>
<p>Flag: <code>gigem{watch_the_night_and_bleed_for_me}</code></p>
</div>
</div>
</div>
<h1 id=_existing_tooling class=sect0>Existing Tooling</h1>
<div class=sect1>
<h2 id=_prompt_3>Prompt</h2>
<div class=sectionbody>
<div class=paragraph>
<p>Have fun reversing this little crackme. :)</p>
</div>
<div class=paragraph>
<p><strong>Given:</strong> existing-tooling binary</p>
</div>
</div>
</div>
<div class=sect1>
<h2 id=_solve_3>Solve</h2>
<div class=sectionbody>
<div class="admonitionblock note">
<table>
<tbody><tr>
<td class=icon>
<div class=title>Note</div>
</td>
<td class=content>
I did not complete this challenge
</td>
</tr>
</tbody></table>
</div>
<div class=paragraph>
<p>First things first with any RE challenge is to check file type and run the bad boy:</p>
</div>
<div class=imageblock>
<div class=content>
<img src=../images/tamuctf/existing_tooling/existing_type.png alt="existing type">
</div>
</div>
<div class=paragraph>
<p>Key thing: the flag is 72 characters long…​ we can look in a handy dandy tool…​</p>
</div>
<div class=paragraph>
<p>Ghidra time!!!</p>
</div>
<div class=paragraph>
<p>When you load the binary into Ghidra and start at the entry, we see this:</p>
</div>
<div class=imageblock>
<div class=content>
<img src=../images/tamuctf/existing_tooling/entry.png alt=entry>
</div>
</div>
<div class=paragraph>
<p>Going into that <code>FUN_00101140</code>, we find an interesting block of code…​ it is a pointer that points to null? Strange.</p>
</div>
<div class=imageblock>
<div class=content>
<img src=../images/tamuctf/existing_tooling/point_null.png alt="point null">
</div>
</div>
<div class=paragraph>
<p>So there is probably something there, so let’s investigate! GDB gef is a life savior :D.</p>
</div>
<div class=paragraph>
<p>Commands:</p>
</div>
<div class=ulist>
<ul>
<li>
<p>gdb existing-tooling → go into gdb (already have gef installed)</p>
</li>
<li>
<p>start → start the program</p>
</li>
<li>
<p>vmmap → this is to get the base address so that I can then set a breakpoint at this sus code block → starts at 0x00000008000000</p>
</li>
<li>
<p>b *0x00000008000000+120d → set a breakpoint at the dereferenced address of base + the offset we see in the image above (don’t include "h" bc that just indicates hex)</p>
</li>
<li>
<p>c → for continue</p>
</li>
<li>
<p>x/s $rbp → we can see part of the flag in the below image, so to get the whole thing, we gotta output the contents of that register (rbp)</p>
</li>
</ul>
</div>
<div class=imageblock>
<div class=content>
<img src=../images/tamuctf/existing_tooling/rbp_flag.png alt="rbp flag">
</div>
</div>
<div class=paragraph>
<p>Flag: <code>gigem{im_curious_did_you_statically_or_dynamically_reverse_ping_addison}</code></p>
</div>
</div>
</div>
</div>
<div class=post-info>
<a class="post-hidden-url u-url" href=https://murphe22.com/posts/tamuctf22/>https://murphe22.com/posts/tamuctf22/</a>
<a href=https://murphe22.com class="p-name p-author post-hidden-author h-card" rel=me>Emily Murphy</a>
<div class=post-taxonomies>
<ul class=post-categories>
<li><a href=https://murphe22.com/categories/writeups/>writeups</a></li>
</ul>
<ul class=post-tags>
<li><a href=https://murphe22.com/tags/ctfs/>#ctfs</a></li>
<li><a href=https://murphe22.com/tags/writeups/>#writeups</a></li>
</ul>
</div>
</div>
</article>
<div class="pagination post-pagination">
<div class="left pagination-item">
<a href=/posts/comptiacysa/>CompTIA CySA+</a>
</div>
<div class="right pagination-item disabled">
</div>
</div>
</main>
<footer class=common-footer>
<div class=common-footer-bottom>
<div class=copyright>
<p>© Emily Murphy, 2023<br>
Powered by <a target=_blank rel="noopener noreferrer" href=https://gohugo.io/>Hugo</a>, theme <a target=_blank rel="noopener noreferrer" href=https://github.com/mitrichius/hugo-theme-anubis>Anubis</a>.<br>
</p>
</div>
<button class=theme-switcher>
Dark theme
</button>
<script>const STORAGE_KEY='user-color-scheme',defaultTheme="light";let currentTheme,switchButton,autoDefinedScheme=window.matchMedia('(prefers-color-scheme: dark)');const autoChangeScheme=a=>{currentTheme=a.matches?'dark':'light',document.documentElement.setAttribute('data-theme',currentTheme),changeButtonText()};document.addEventListener('DOMContentLoaded',function(){switchButton=document.querySelector('.theme-switcher'),currentTheme=detectCurrentScheme(),currentTheme=='dark'&&document.documentElement.setAttribute('data-theme','dark'),currentTheme=='auto'&&(autoChangeScheme(autoDefinedScheme),autoDefinedScheme.addListener(autoChangeScheme)),changeButtonText(),switchButton.addEventListener('click',switchTheme,!1)});function detectCurrentScheme(){return localStorage.getItem(STORAGE_KEY)?localStorage.getItem(STORAGE_KEY):defaultTheme?defaultTheme:window.matchMedia?window.matchMedia('(prefers-color-scheme: dark)').matches?'dark':'light':'light'}function changeButtonText(){switchButton.textContent=currentTheme=='dark'?"Light theme":"Dark theme"}function switchTheme(a){currentTheme=='dark'?(localStorage.setItem(STORAGE_KEY,'light'),document.documentElement.setAttribute('data-theme','light'),currentTheme='light'):(localStorage.setItem(STORAGE_KEY,'dark'),document.documentElement.setAttribute('data-theme','dark'),currentTheme='dark'),changeButtonText()}</script>
</div>
<p class="h-card vcard">
<a href=https://murphe22.com class="p-name u-url url fn" rel=me>Emily Murphy</a>
</p>
</footer>
</div>
</body>
</html>