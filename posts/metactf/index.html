<!doctype html><html lang=en-us data-theme>
<head>
<meta charset=utf-8>
<meta name=HandheldFriendly content="True">
<meta name=viewport content="width=device-width,initial-scale=1">
<meta name=referrer content="no-referrer-when-downgrade">
<title>MetaCTF 2021 - Emily's Personal Website!</title>
<meta name=description content="MetaCTF CyberGames 2021">
<link rel=icon type=image/x-icon href=https://murphe22.com/favicon.ico>
<link rel=apple-touch-icon-precomposed href=https://murphe22.com/favicon.png>
<link rel=stylesheet href=https://murphe22.com/css/style.min.9a5aaab18cf72e04b271c3974ff2d090e83d694022c39e89cb5de41ead7d0fea.css integrity="sha256-mlqqsYz3LgSyccOXT/LQkOg9aUAiw56Jy13kHq19D+o=">
<script src=https://murphe22.com/js/script.min.510c781c39dbb21b4c76d85c82e2bdf4689220adbb7cd61e49e9d293e442fb42.js type=text/javascript integrity="sha256-UQx4HDnbshtMdthcguK99GiSIK27fNYeSenSk+RC+0I="></script>
<meta property="og:title" content="MetaCTF 2021">
<meta property="og:description" content="MetaCTF CyberGames 2021">
<meta property="og:type" content="article">
<meta property="og:url" content="https://murphe22.com/posts/metactf/"><meta property="article:section" content="posts">
<meta property="article:published_time" content="2021-12-03T00:00:00+00:00">
<meta property="article:modified_time" content="2021-12-03T00:00:00+00:00">
<meta name=twitter:card content="summary">
<meta name=twitter:title content="MetaCTF 2021">
<meta name=twitter:description content="MetaCTF CyberGames 2021">
</head>
<body>
<a class=skip-main href=#main>Skip to main content</a>
<div class=container>
<header class=common-header>
<div class=header-top>
<h1 class=site-title>
<a href=/>Emily's Personal Website!</a>
</h1>
<ul class=social-icons>
<li>
<a href=https://www.linkedin.com/in/murphe22/ title=Linkedin rel=me>
<span class=inline-svg><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path fill="currentcolor" d="M416 32H31.9C14.3 32 0 46.5.0 64.3v383.4C0 465.5 14.3 480 31.9 480H416c17.6.0 32-14.5 32-32.3V64.3c0-17.8-14.4-32.3-32-32.3zM135.4 416H69V202.2h66.5V416zm-33.2-243c-21.3.0-38.5-17.3-38.5-38.5S80.9 96 102.2 96c21.2.0 38.5 17.3 38.5 38.5.0 21.3-17.2 38.5-38.5 38.5zm282.1 243h-66.4V312c0-24.8-.5-56.7-34.5-56.7-34.6.0-39.9 27-39.9 54.9V416h-66.4V202.2h63.7v29.2h.9c8.9-16.8 30.6-34.5 62.9-34.5 67.2.0 79.7 44.3 79.7 101.9V416z"/></svg>
</span>
</a>
</li>
<li>
<a href=https://github.com/emurph1 title=Github rel=me>
<span class=inline-svg><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><path fill="currentcolor" d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6.0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6.0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3.0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1.0-6.2-.3-40.4-.3-61.4.0.0-70 15-84.7-29.8.0.0-11.4-29.1-27.8-36.6.0.0-22.9-15.7 1.6-15.4.0.0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5.0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9.0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4.0 33.7-.3 75.4-.3 83.6.0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6.0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9.0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
</span>
</a>
</li>
<li>
<a href=https://github.com/emurph1 title=Twitter rel=me>
<span class=inline-svg><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentcolor" d="M459.37 151.716c.325 4.548.325 9.097.325 13.645.0 138.72-105.583 298.558-298.558 298.558-59.452.0-114.68-17.219-161.137-47.106 8.447.974 16.568 1.299 25.34 1.299 49.055.0 94.213-16.568 130.274-44.832-46.132-.975-84.792-31.188-98.112-72.772 6.498.974 12.995 1.624 19.818 1.624 9.421.0 18.843-1.3 27.614-3.573-48.081-9.747-84.143-51.98-84.143-102.985v-1.299c13.969 7.797 30.214 12.67 47.431 13.319-28.264-18.843-46.781-51.005-46.781-87.391.0-19.492 5.197-37.36 14.294-52.954 51.655 63.675 129.3 105.258 216.365 109.807-1.624-7.797-2.599-15.918-2.599-24.04.0-57.828 46.782-104.934 104.934-104.934 30.213.0 57.502 12.67 76.67 33.137 23.715-4.548 46.456-13.32 66.599-25.34-7.798 24.366-24.366 44.833-46.132 57.827 21.117-2.273 41.584-8.122 60.426-16.243-14.292 20.791-32.161 39.308-52.628 54.253z"/></svg>
</span>
</a>
</li>
</ul>
</div>
<nav>
<a href=https://murphe22.com/about/ title>About</a>
<a href=https://murphe22.com/posts/ title>Writeups</a>
<a href=https://murphe22.com/contact/ title>Contact</a>
<a href=https://murphe22.com/tags/ title>Tags</a>
</nav>
</header>
<main id=main tabindex=-1>
<article class="post h-entry">
<div class=post-header>
<header>
<h1 class="p-name post-title">MetaCTF 2021</h1>
</header>
</div>
<div class="content e-content">
<p>Starting Friday, December 3rd, 2021, MetaCTF will host it&rsquo;s 7th annual virtual jeopardy-style CTF! This event is free and open to everyone, and participants can compete in teams of up to 4.</p>
<p>This CTF will challenge participants of all skill levels to learn new cybersecurity techniques and skills, with problems covering a variety of topics such as web exploitation, cryptography, binary exploitation, reverse engineering, forensics, and reconnaissance.</p>
<h1 id=intro>Intro
<span>
<a href=#intro><svg viewBox="0 0 28 23" height="100%" width="19" xmlns="http://www.w3.org/2000/svg"><path d="M10 13a5 5 0 007.54.54l3-3a5 5 0 00-7.07-7.07l-1.72 1.71" fill="none" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2"/><path d="M14 11a5 5 0 00-7.54-.54l-3 3a5 5 0 007.07 7.07l1.71-1.71" fill="none" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2"/></svg>
</a>
</span>
</h1><p>This CTF was the first time our club has participated and it was an absolute blast. Thank you to my awesome team members (Rohan, Lane, and Bode)!!! We placed 58th overall and 25th amongst student teams!</p>
<h1 id=darryl-vault>Darryl Vault
<span>
<a href=#darryl-vault><svg viewBox="0 0 28 23" height="100%" width="19" xmlns="http://www.w3.org/2000/svg"><path d="M10 13a5 5 0 007.54.54l3-3a5 5 0 00-7.07-7.07l-1.72 1.71" fill="none" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2"/><path d="M14 11a5 5 0 00-7.54-.54l-3 3a5 5 0 007.07 7.07l1.71-1.71" fill="none" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2"/></svg>
</a>
</span>
</h1><p>Dread Pirate Darryl has no qualms with a little bit - or a lot - of thievery, as you recently found out to your detriment. Suffice it to say his loot stash has grown quite a bit, and you find yourself down a whole bunch of valuables. This is, put simply, unacceptable. You need to rectify this situation, and returning the favor ought to do the trick.</p>
<p>As a Dread Pirate, Dread Pirate Darryl has much better things to do than remembering all of his secrets, such as raiding other innocent CTF-goers or shouting &ldquo;ARRRRR&rdquo; at the top of his lungs repeatedly. Darryl commissioned a secret vault program to be written for him so that when he needs to take newly acquired loot back to his lair, he can ask it where he has to go.</p>
<p>Unfortunately for Dread Pirate Darryl, the developer from whom he commissioned the vault was very proud of his work and wanted to show it off, and we here at MetaCTF have acquired a copy of it. Find Dread Pirate Darryl&rsquo;s treasures! Enact your revenge!</p>
<p>Note: The flag is the password used to access the location of Dread Pirate Darryl&rsquo;s treasure.</p>
<h2 id=solve>Solve
<span>
<a href=#solve><svg viewBox="0 0 28 23" height="100%" width="19" xmlns="http://www.w3.org/2000/svg"><path d="M10 13a5 5 0 007.54.54l3-3a5 5 0 00-7.07-7.07l-1.72 1.71" fill="none" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2"/><path d="M14 11a5 5 0 00-7.54-.54l-3 3a5 5 0 007.07 7.07l1.71-1.71" fill="none" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2"/></svg>
</a>
</span>
</h2><p>First, i just ran the file to see what was going on and saw that there were four different options.
I went to ghidra, looked at the entry, got the first argument of libc start main and renamed main
Rebase Ghidra
Break main and look at what it‚Äôs doing
We have four possible inputs, right?
1, 2 3, 4</p>
<p>Mother‚Äôs maiden name does not prompt for a password</p>
<p>The password for 2&3 is just chilling in strings DARRYL_IS_THE_GREATEST</p>
<p>4 asks for a password, but it doesnt output anything else. Hmmmmmmmmmmmm üëÄ</p>
<p>Essentially, the password is checked on three separate occasions
We return to ghidra. Defined strings go burrrrr. ‚ÄúHey, Darryl, I&rsquo;m going to need your password‚Äù has three functions nearby it. Three???? hmmmmmmmmmmmmmmm</p>
<p><img src=/content/posts/images/metactf/message.png alt=idek></p>
<p>Why dont we click on those functions üëÄ</p>
<p>Oh cool that last one looks sexy</p>
<p>This is where i found the function i named funcwithtoomanynums. U will know it when u see it</p>
<p>Inside that, the memcmp 0x27 goooo burrrrrr</p>
<p>Let‚Äôs just fuck around in gdb and break at this memcmp with ‚Äòaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa‚Äô bc its len is 0x27</p>
<p>Gdb go burrrrrr
ty gdb v cool</p>
<p><img src=/content/posts/images/metactf/flag.png alt="flag in memory"></p>
<h1 id=easy-as-it-is>Easy as it is
<span>
<a href=#easy-as-it-is><svg viewBox="0 0 28 23" height="100%" width="19" xmlns="http://www.w3.org/2000/svg"><path d="M10 13a5 5 0 007.54.54l3-3a5 5 0 00-7.07-7.07l-1.72 1.71" fill="none" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2"/><path d="M14 11a5 5 0 00-7.54-.54l-3 3a5 5 0 007.07 7.07l1.71-1.71" fill="none" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2"/></svg>
</a>
</span>
</h1><p>Caleb was designing a problem for MetaCTF where the flag would be in the telnet plaintext. Unfortunately, he accidentally stopped the packet capture right before the flag was supposed to be revealed. Can you still find the flag? Note: You&rsquo;ll need to decrypt in CyberChef rather than using a command line utility.</p>
<h2 id=solve-1>Solve
<span>
<a href=#solve-1><svg viewBox="0 0 28 23" height="100%" width="19" xmlns="http://www.w3.org/2000/svg"><path d="M10 13a5 5 0 007.54.54l3-3a5 5 0 00-7.07-7.07l-1.72 1.71" fill="none" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2"/><path d="M14 11a5 5 0 00-7.54-.54l-3 3a5 5 0 007.07 7.07l1.71-1.71" fill="none" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2"/></svg>
</a>
</span>
</h2><p>Get the PGP message and private key from the pcap. Put it in CyberChef and notice it is still messed up. So, mess around with the decrompression and find that <code>gzip</code> works.</p>
<p><img src=/content/posts/images/metactf/cyberChef.png alt=cyberchef></p>
<p><code>MetaCTF{cleartext_private_pgp_keys}</code></p>
<h1 id=i-hate-python>I Hate Python
<span>
<a href=#i-hate-python><svg viewBox="0 0 28 23" height="100%" width="19" xmlns="http://www.w3.org/2000/svg"><path d="M10 13a5 5 0 007.54.54l3-3a5 5 0 00-7.07-7.07l-1.72 1.71" fill="none" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2"/><path d="M14 11a5 5 0 00-7.54-.54l-3 3a5 5 0 007.07 7.07l1.71-1.71" fill="none" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2"/></svg>
</a>
</span>
</h1><p>I hate Python, and now you will too. Find the password.</p>
<h2 id=solve-2>Solve
<span>
<a href=#solve-2><svg viewBox="0 0 28 23" height="100%" width="19" xmlns="http://www.w3.org/2000/svg"><path d="M10 13a5 5 0 007.54.54l3-3a5 5 0 00-7.07-7.07l-1.72 1.71" fill="none" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2"/><path d="M14 11a5 5 0 00-7.54-.54l-3 3a5 5 0 007.07 7.07l1.71-1.71" fill="none" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2"/></svg>
</a>
</span>
</h2><p>Scripting fun:</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=color:#ff79c6>import</span> random

<span style=color:#ff79c6>def</span> <span style=color:#50fa7b>do_thing</span>(a, b):
    <span style=color:#ff79c6>return</span> ((a <span style=color:#ff79c6>&lt;&lt;</span> <span style=color:#bd93f9>1</span>) <span style=color:#ff79c6>&amp;</span> b) <span style=color:#ff79c6>^</span> ((a <span style=color:#ff79c6>&lt;&lt;</span> <span style=color:#bd93f9>1</span>) <span style=color:#ff79c6>|</span> b)

<span style=color:#ff79c6>def</span> <span style=color:#50fa7b>checkFlag</span>(x, prevLen):
    random<span style=color:#ff79c6>.</span>seed(<span style=color:#bd93f9>997</span>)
    k <span style=color:#ff79c6>=</span> [random<span style=color:#ff79c6>.</span>randint(<span style=color:#bd93f9>0</span>, <span style=color:#bd93f9>256</span>) <span style=color:#ff79c6>for</span> _ <span style=color:#ff79c6>in</span> <span style=color:#8be9fd;font-style:italic>range</span>(<span style=color:#8be9fd;font-style:italic>len</span>(x))]
    a <span style=color:#ff79c6>=</span> { b: do_thing(<span style=color:#8be9fd;font-style:italic>ord</span>(c), d) <span style=color:#ff79c6>for</span> (b, c), d <span style=color:#ff79c6>in</span> <span style=color:#8be9fd;font-style:italic>zip</span>(<span style=color:#8be9fd;font-style:italic>enumerate</span>(x), k) }
    b <span style=color:#ff79c6>=</span> <span style=color:#8be9fd;font-style:italic>list</span>(<span style=color:#8be9fd;font-style:italic>range</span>(<span style=color:#8be9fd;font-style:italic>len</span>(x)))
    random<span style=color:#ff79c6>.</span>shuffle(b)
    c <span style=color:#ff79c6>=</span> [a[i] <span style=color:#ff79c6>for</span> i <span style=color:#ff79c6>in</span> b[::<span style=color:#ff79c6>-</span><span style=color:#bd93f9>1</span>]]
    <span style=color:#6272a4># print(k)</span>
    <span style=color:#6272a4># print(c)</span>
    kn <span style=color:#ff79c6>=</span> [<span style=color:#bd93f9>47</span>, <span style=color:#bd93f9>123</span>, <span style=color:#bd93f9>113</span>, <span style=color:#bd93f9>232</span>, <span style=color:#bd93f9>118</span>, <span style=color:#bd93f9>98</span>, <span style=color:#bd93f9>183</span>, <span style=color:#bd93f9>183</span>, <span style=color:#bd93f9>77</span>, <span style=color:#bd93f9>64</span>, <span style=color:#bd93f9>218</span>, <span style=color:#bd93f9>223</span>, <span style=color:#bd93f9>232</span>, <span style=color:#bd93f9>82</span>, <span style=color:#bd93f9>16</span>, <span style=color:#bd93f9>72</span>, <span style=color:#bd93f9>68</span>, <span style=color:#bd93f9>191</span>, <span style=color:#bd93f9>54</span>, <span style=color:#bd93f9>116</span>, <span style=color:#bd93f9>38</span>, <span style=color:#bd93f9>151</span>, <span style=color:#bd93f9>174</span>, <span style=color:#bd93f9>234</span>, <span style=color:#bd93f9>127</span>]
    valid <span style=color:#ff79c6>=</span> <span style=color:#8be9fd;font-style:italic>len</span>(<span style=color:#8be9fd;font-style:italic>list</span>(<span style=color:#8be9fd;font-style:italic>filter</span>(<span style=color:#ff79c6>lambda</span> s: kn[s[<span style=color:#bd93f9>0</span>]] <span style=color:#ff79c6>==</span> s[<span style=color:#bd93f9>1</span>], <span style=color:#8be9fd;font-style:italic>enumerate</span>(c))))
    <span style=color:#6272a4># print(valid)</span>
    <span style=color:#ff79c6>if</span> valid <span style=color:#ff79c6>&gt;</span> prevLen:
        <span style=color:#ff79c6>return</span> <span style=color:#ff79c6>True</span>
    <span style=color:#ff79c6>return</span> <span style=color:#ff79c6>False</span>

<span style=color:#6272a4>#random.seed(997)</span>

k <span style=color:#ff79c6>=</span> [random<span style=color:#ff79c6>.</span>randint(<span style=color:#bd93f9>0</span>, <span style=color:#bd93f9>256</span>) <span style=color:#ff79c6>for</span> _ <span style=color:#ff79c6>in</span> <span style=color:#8be9fd;font-style:italic>range</span>(<span style=color:#bd93f9>25</span>)]
<span style=color:#6272a4># print(k)</span>

<span style=color:#6272a4>#x = &#34;A&#34;*25</span>

<span style=color:#6272a4># a = {b: do_thing(ord(c), d) for (b, c), d in zip(enumerate(x), k)}</span>

<span style=color:#6272a4>#kn = [47, 123, 113, 232, 118, 98, 183, 183, 77, 64, 218, 223, 232, 82, 16, 72, 68, 191, 54, 116, 38, 151, 174, 234, 127]</span>

<span style=color:#6272a4># write a loop to go through all the possible ascii </span>
<span style=color:#6272a4># values and do_thing it with all values in k</span>

currFlag <span style=color:#ff79c6>=</span> <span style=color:#f1fa8c>&#39;MetaCTF{&#39;</span>

<span style=color:#ff79c6>for</span> i <span style=color:#ff79c6>in</span> <span style=color:#8be9fd;font-style:italic>range</span>(<span style=color:#bd93f9>25</span> <span style=color:#ff79c6>-</span> <span style=color:#bd93f9>8</span>):
    <span style=color:#ff79c6>for</span> j <span style=color:#ff79c6>in</span> <span style=color:#8be9fd;font-style:italic>range</span>(<span style=color:#bd93f9>0</span>, <span style=color:#bd93f9>128</span>):
        nextFlag <span style=color:#ff79c6>=</span> currFlag <span style=color:#ff79c6>+</span> <span style=color:#8be9fd;font-style:italic>chr</span>(j) <span style=color:#ff79c6>+</span> <span style=color:#f1fa8c>&#39;A&#39;</span><span style=color:#ff79c6>*</span>(<span style=color:#bd93f9>16</span><span style=color:#ff79c6>-</span>i)
        <span style=color:#6272a4># print(&#34;test&#34;)</span>
        <span style=color:#8be9fd;font-style:italic>print</span>(nextFlag)
        <span style=color:#ff79c6>assert</span>(<span style=color:#8be9fd;font-style:italic>len</span>(nextFlag) <span style=color:#ff79c6>==</span> <span style=color:#bd93f9>25</span>)
        <span style=color:#ff79c6>if</span> checkFlag(nextFlag, <span style=color:#8be9fd;font-style:italic>len</span>(currFlag)):
            <span style=color:#6272a4># print(nextFlag)</span>
            currFlag <span style=color:#ff79c6>=</span> currFlag <span style=color:#ff79c6>+</span> <span style=color:#8be9fd;font-style:italic>chr</span>(j)
            <span style=color:#ff79c6>break</span>

<span style=color:#6272a4># print(currFlag)</span>
</code></pre></div><p><code>MetaCTF{yOu_w!N_th1$_0n3}</code></p>
<h1 id=interception-i>Interception I
<span>
<a href=#interception-i><svg viewBox="0 0 28 23" height="100%" width="19" xmlns="http://www.w3.org/2000/svg"><path d="M10 13a5 5 0 007.54.54l3-3a5 5 0 00-7.07-7.07l-1.72 1.71" fill="none" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2"/><path d="M14 11a5 5 0 00-7.54-.54l-3 3a5 5 0 007.07 7.07l1.71-1.71" fill="none" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2"/></svg>
</a>
</span>
</h1><p>192.168.0.1 is periodically (once every 4 seconds) sending the flag to 192.168.0.2 over UDP port 8000. Go get it.
ssh <a href=mailto:ctf-1@host.cg21.metaproblems.com>ctf-1@host.cg21.metaproblems.com</a> -p 7000</p>
<p>If you get an SSH host key error, consider using
ssh -o &ldquo;UserKnownHostsFile=/dev/null&rdquo; -o &ldquo;StrictHostKeyChecking=no&rdquo; <a href=mailto:ctf-1@host.cg21.metaproblems.com>ctf-1@host.cg21.metaproblems.com</a> -p 7000</p>
<p>Note that the connection can take a while to initialize. It will say Granting console connection to device&mldr; and then three dots will appear. After the third dot you should have a connection.</p>
<h2 id=solve-note-i-did-this-at-2-am>Solve (Note I did this at 2 AM)
<span>
<a href=#solve-note-i-did-this-at-2-am><svg viewBox="0 0 28 23" height="100%" width="19" xmlns="http://www.w3.org/2000/svg"><path d="M10 13a5 5 0 007.54.54l3-3a5 5 0 00-7.07-7.07l-1.72 1.71" fill="none" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2"/><path d="M14 11a5 5 0 00-7.54-.54l-3 3a5 5 0 007.07 7.07l1.71-1.71" fill="none" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2"/></svg>
</a>
</span>
</h2><p>Gotta do some ip spoofing.</p>
<ol>
<li>first changed ip address to spoofy</li>
</ol>
<p><code>ifconfig eth0 192.168.0.2 netmask 255.255.255.0</code></p>
<ol start=2>
<li>then do a lil ping to test connection and refresh arp cache so we changed the ip address</li>
</ol>
<p><code>ping 192.168.0.1</code></p>
<ol start=3>
<li>then do a lil nmap mappy</li>
</ol>
<p><code>nmap -sn -PU 192.168.0.0/24</code></p>
<ol start=4>
<li>then do a lil net catty cat</li>
</ol>
<p><code>nc -lu 192.168.0.2 8000</code></p>
<p><code>MetaCTF{addr3s5_r3s0lut1on_pwn4g3}</code></p>
<h1 id=interception-ii>Interception II
<span>
<a href=#interception-ii><svg viewBox="0 0 28 23" height="100%" width="19" xmlns="http://www.w3.org/2000/svg"><path d="M10 13a5 5 0 007.54.54l3-3a5 5 0 00-7.07-7.07l-1.72 1.71" fill="none" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2"/><path d="M14 11a5 5 0 00-7.54-.54l-3 3a5 5 0 007.07 7.07l1.71-1.71" fill="none" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2"/></svg>
</a>
</span>
</h1><p>Someone on this network is periodically sending the flag to &mldr; someone else on this network, over TCP port 8000. Go get it.
ssh <a href=mailto:ctf-46ed3559da08@host.cg21.metaproblems.com>ctf-46ed3559da08@host.cg21.metaproblems.com</a> -p 7000</p>
<h2 id=solve-3>Solve
<span>
<a href=#solve-3><svg viewBox="0 0 28 23" height="100%" width="19" xmlns="http://www.w3.org/2000/svg"><path d="M10 13a5 5 0 007.54.54l3-3a5 5 0 00-7.07-7.07l-1.72 1.71" fill="none" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2"/><path d="M14 11a5 5 0 00-7.54-.54l-3 3a5 5 0 007.07 7.07l1.71-1.71" fill="none" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2"/></svg>
</a>
</span>
</h2><p>Similar process to Interception I.</p>
<ol>
<li>There are more hosts up, so let&rsquo;s see what is open.</li>
</ol>
<p><code>nmap -p 8000 192.168.0.0/24 -v | grep open</code></p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python>Discovered <span style=color:#8be9fd;font-style:italic>open</span> port <span style=color:#bd93f9>8000</span><span style=color:#ff79c6>/</span>tcp on <span style=color:#bd93f9>192.168.0.78</span>
<span style=color:#bd93f9>8000</span><span style=color:#ff79c6>/</span>tcp <span style=color:#8be9fd;font-style:italic>open</span> http<span style=color:#ff79c6>-</span>alt
</code></pre></div><ol start=2>
<li>Ping to test connection.</li>
</ol>
<p><code>ping 192.168.0.78</code></p>
<ol start=3>
<li>Check interface that we gotta change</li>
</ol>
<p><code>arp -a</code></p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python>ip<span style=color:#ff79c6>-</span><span style=color:#bd93f9>192</span><span style=color:#ff79c6>-</span><span style=color:#bd93f9>168</span><span style=color:#ff79c6>-</span><span style=color:#bd93f9>0</span><span style=color:#ff79c6>-</span><span style=color:#bd93f9>78.</span>ec2<span style=color:#ff79c6>.</span>internal (<span style=color:#bd93f9>192.168.0.78</span>) at <span style=color:#bd93f9>02</span>:<span style=color:#bd93f9>42</span>:<span style=color:#bd93f9>0</span>a:<span style=color:#bd93f9>00</span>:a3:c3 [ether] on eth0
</code></pre></div><ol start=4>
<li>Change the ip</li>
</ol>
<p><code>ifconfig eth0 192.168.0.78 netmask 255.255.255.0</code></p>
<ol start=5>
<li>
<p><code>ping 192.168.0.78</code> to refresh the arp cache so it does the spoofy</p>
</li>
<li>
<p>Setup the netcat connection</p>
</li>
</ol>
<p><code>nc -lvp 8000</code></p>
<p><code>MetaCTF{s0_m4ny_1ps_but_wh1ch_t0_ch00s3}</code></p>
<h1 id=interception-iii>Interception III
<span>
<a href=#interception-iii><svg viewBox="0 0 28 23" height="100%" width="19" xmlns="http://www.w3.org/2000/svg"><path d="M10 13a5 5 0 007.54.54l3-3a5 5 0 00-7.07-7.07l-1.72 1.71" fill="none" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2"/><path d="M14 11a5 5 0 00-7.54-.54l-3 3a5 5 0 007.07 7.07l1.71-1.71" fill="none" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2"/></svg>
</a>
</span>
</h1><p>192.168.55.3 is periodically sending the flag to 172.16.0.2 over UDP port 8000. Go get it.
By the way, I&rsquo;ve been told the admins at this organization use really shoddy passwords.
ssh <a href=mailto:ctf-f36ef72cadc1@host.cg21.metaproblems.com>ctf-f36ef72cadc1@host.cg21.metaproblems.com</a> -p 7000
Note: The password for this user is the flag from Interception I. You must finish Interception I before starting this challenge.</p>
<h2 id=solve-4>Solve
<span>
<a href=#solve-4><svg viewBox="0 0 28 23" height="100%" width="19" xmlns="http://www.w3.org/2000/svg"><path d="M10 13a5 5 0 007.54.54l3-3a5 5 0 00-7.07-7.07l-1.72 1.71" fill="none" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2"/><path d="M14 11a5 5 0 00-7.54-.54l-3 3a5 5 0 007.07 7.07l1.71-1.71" fill="none" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2"/></svg>
</a>
</span>
</h2><p>First enumerate&mldr;. <code>nmap -v 192.168.0.0/24</code></p>
<p><img src=/content/posts/images/metactf/I3scan.png alt="nmap scan"></p>
<p>So&mldr; telnet means we can connect to smtn&mldr; we know it is a router bc usually default gateways have an end address of &lt;0-9>.&lt;0-9>.&lt;0-9>.<strong>1</strong></p>
<p>Gotta identify the router</p>
<p><code>nmap -O 192.168.0.1</code></p>
<pre tabindex=0><code>Starting Nmap 7.92 ( https://nmap.org ) at 2021-12-05 08:57 UTC
Nmap scan report for ip-192-168-0-1.ec2.internal (192.168.0.1)
Host is up (0.000077s latency).
Not shown: 999 closed tcp ports (reset)
PORT   STATE SERVICE
23/tcp open  telnet
MAC Address: 02:42:0A:00:0F:42 (Unknown)
Device type: general purpose
Running: Linux 4.X|5.X
OS CPE: cpe:/o:linux:linux_kernel:4 cpe:/o:linux:linux_kernel:5
OS details: Linux 4.15 - 5.6
Network Distance: 1 hop
</code></pre><p>Important: <strong>Linux 4.15-5.6</strong></p>
<p>google search: routers that use Linux 4.15 - 5.6 -> TP-Link</p>
<p>Find root login -> <a href=https://www.cleancss.com/router-default/TP-Link>TP Link Default Creds</a></p>
<pre tabindex=0><code>username: root
password: admin
</code></pre><p>When you get access, and do an <code>ls</code>, find bird-2.0.8 ->
<a href=https://blog.kintone.io/entry/bird>https://blog.kintone.io/entry/bird</a> and <a href="https://bird.network.cz/?get_doc&f=bird-4.html">https://bird.network.cz/?get_doc&f=bird-4.html</a></p>
<p>Did not solve, but was ON THE RIGHT TRACK. At 4AM, I tried changing the OSPF cost BUT I CHANGED THE WRONG INTERFACE&rsquo;S COST. BIG SAD.</p>
<p>Here is the writeup from another person&mldr; for next time.</p>
<p><img src=/content/posts/images/metactf/birdShit.png alt=solve></p>
<h1 id=where-in-the-world>Where in the World
<span>
<a href=#where-in-the-world><svg viewBox="0 0 28 23" height="100%" width="19" xmlns="http://www.w3.org/2000/svg"><path d="M10 13a5 5 0 007.54.54l3-3a5 5 0 00-7.07-7.07l-1.72 1.71" fill="none" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2"/><path d="M14 11a5 5 0 00-7.54-.54l-3 3a5 5 0 007.07 7.07l1.71-1.71" fill="none" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2"/></svg>
</a>
</span>
</h1><p>I must say, every time I see one of these directional signs, I think I&rsquo;ve got to make this into a CTF problem. It&rsquo;s the idea of Open Source Intelligence (OSINT) or Geospatial Intelligence (GEOINT). The idea of being able to take an image and use all of the clues within it to infer details such as where it&rsquo;s at or what&rsquo;s happening in the photo.</p>
<p>Here is one such picture of those signs. Your goal? Use those little details to find the name of the marina it&rsquo;s at which you&rsquo;ll submit for the flag (so MetaCTF{name of marina}</p>
<p><img src=/content/posts/images/metactf/sign_of_cities.png alt=picture></p>
<h2 id=solve-5>Solve
<span>
<a href=#solve-5><svg viewBox="0 0 28 23" height="100%" width="19" xmlns="http://www.w3.org/2000/svg"><path d="M10 13a5 5 0 007.54.54l3-3a5 5 0 00-7.07-7.07l-1.72 1.71" fill="none" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2"/><path d="M14 11a5 5 0 00-7.54-.54l-3 3a5 5 0 007.07 7.07l1.71-1.71" fill="none" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2"/></svg>
</a>
</span>
</h2><p>Google image search go brrrr.</p>
<p><a href="https://www.google.com/search?tbs=simg:CAESYgm4egF4qbenjhpXCxCwjKcIGjsKOQgEEhSLHvcB1A2jDM8esSSJJsYRqS2wGhobsSNyV5t0GyxbYWZWX4cdF4DSw67Sa_1SydHZ0IAUwBAwLEI6u_1ggaCgoICAESBAXC5ToM&q=marina+&tbm=isch#imgrc=lI4Z2r9ahay2oM">Search</a></p>
<p><a href="https://www.google.com/url?sa=i&url=https%3A%2F%2Fwww.facebook.com%2FEgg-Harbor-Marina-Beach-206274509466545%2F&psig=AOvVaw19faRmXpPwUl5JjE_6oYTM&ust=1638681451821000&source=images&cd=vfe&ved=0CAwQjhxqFwoTCJCsmqGyyfQCFQAAAAAdAAAAABAD">Egg Harbor</a></p>
<p><code>MetaCTF(egg_harbor)</code></p>
<h1 id=yummy-vegetables>Yummy Vegetables
<span>
<a href=#yummy-vegetables><svg viewBox="0 0 28 23" height="100%" width="19" xmlns="http://www.w3.org/2000/svg"><path d="M10 13a5 5 0 007.54.54l3-3a5 5 0 00-7.07-7.07l-1.72 1.71" fill="none" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2"/><path d="M14 11a5 5 0 00-7.54-.54l-3 3a5 5 0 007.07 7.07l1.71-1.71" fill="none" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2"/></svg>
</a>
</span>
</h1><p>I love me my vegetables, but I can never remember what color they are! I know lots of people have this problem, so I made a site to help.</p>
<p>Here&rsquo;s some sauce to go with the vegetables: index.js</p>
<h2 id=solve-6>Solve
<span>
<a href=#solve-6><svg viewBox="0 0 28 23" height="100%" width="19" xmlns="http://www.w3.org/2000/svg"><path d="M10 13a5 5 0 007.54.54l3-3a5 5 0 00-7.07-7.07l-1.72 1.71" fill="none" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2"/><path d="M14 11a5 5 0 00-7.54-.54l-3 3a5 5 0 007.07 7.07l1.71-1.71" fill="none" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2"/></svg>
</a>
</span>
</h2><p>Looking at the JS, we see that a query is sent so you can do a UNION attack on this boi.</p>
<p>Make sure you have the same number of columns as the first query though.</p>
<p>To find the number of columns, look at the response after submitting a query (we can just do a empty search).</p>
<p><code>UNION SELECT 1, 2, flag FROM the_flag_is_in_here_730387f4b640c398a3d769a39f9cf9b5;--1</code></p>
<p><code>MetaCTF{sql1t3_m4st3r_0r_just_gu3ss_g0d??}</code></p>
<h1 id=the-best-laid-plain>The Best Laid Plain
<span>
<a href=#the-best-laid-plain><svg viewBox="0 0 28 23" height="100%" width="19" xmlns="http://www.w3.org/2000/svg"><path d="M10 13a5 5 0 007.54.54l3-3a5 5 0 00-7.07-7.07l-1.72 1.71" fill="none" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2"/><path d="M14 11a5 5 0 00-7.54-.54l-3 3a5 5 0 007.07 7.07l1.71-1.71" fill="none" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2"/></svg>
</a>
</span>
</h1><p>Sometimes, routers can break packets up into fragments to meet abnormal networking requirements, and the endpoint will be responsible for putting these back together. Sometimes however, this doesn&rsquo;t go as planned, as Microsoft found out with CVE-2021-24074. We&rsquo;d like to see the function responsible for this vulnerability, but we&rsquo;re having some trouble finding its name&mldr; Could you see if you could find it?</p>
<h2 id=solve-7>Solve
<span>
<a href=#solve-7><svg viewBox="0 0 28 23" height="100%" width="19" xmlns="http://www.w3.org/2000/svg"><path d="M10 13a5 5 0 007.54.54l3-3a5 5 0 00-7.07-7.07l-1.72 1.71" fill="none" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2"/><path d="M14 11a5 5 0 00-7.54-.54l-3 3a5 5 0 007.07 7.07l1.71-1.71" fill="none" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2"/></svg>
</a>
</span>
</h2><p><a href="https://duckduckgo.com/?q=%22CVE-2021-24074%22+writeup&t=ffab&ia=web">https://duckduckgo.com/?q=%22CVE-2021-24074%22+writeup&t=ffab&ia=web</a></p>
<p><a href=https://www.armis.com/blog/from-urgent11-to-frag44-microsoft-patches-critical-vulnerabilities-in-windows-tcpip-stack/>https://www.armis.com/blog/from-urgent11-to-frag44-microsoft-patches-critical-vulnerabilities-in-windows-tcpip-stack/</a></p>
<p><code>MetaCTF{Ipv4pReceiveRoutingHeader}</code></p>
<h1 id=pattern-of-life>Pattern of Life
<span>
<a href=#pattern-of-life><svg viewBox="0 0 28 23" height="100%" width="19" xmlns="http://www.w3.org/2000/svg"><path d="M10 13a5 5 0 007.54.54l3-3a5 5 0 00-7.07-7.07l-1.72 1.71" fill="none" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2"/><path d="M14 11a5 5 0 00-7.54-.54l-3 3a5 5 0 007.07 7.07l1.71-1.71" fill="none" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2"/></svg>
</a>
</span>
</h1><p>Hackers have breached our network. We know they are there, hiding in the shadows as users continue to browse the web like normal. As a threat hunter, your job is to constantly be searching our environment for any signs of malicious behavior.</p>
<p>Today you just received a packet capture (pcap) from a user&rsquo;s workstation. We think that an attacker may have compromised the user&rsquo;s machine and that the computer is beaconing out to their command and control (C2) server. Based on some other logs, we also think the attacker was <em>not</em> using a fully encrypted protocol and also did not put much care into making their C2 server look like a normal website. Your task? We&rsquo;d like you to submit the port number that the C2 server is listening on in the form of MetaCTF{portnumber} as the flag.</p>
<h2 id=solve-8>Solve
<span>
<a href=#solve-8><svg viewBox="0 0 28 23" height="100%" width="19" xmlns="http://www.w3.org/2000/svg"><path d="M10 13a5 5 0 007.54.54l3-3a5 5 0 00-7.07-7.07l-1.72 1.71" fill="none" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2"/><path d="M14 11a5 5 0 00-7.54-.54l-3 3a5 5 0 007.07 7.07l1.71-1.71" fill="none" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2"/></svg>
</a>
</span>
</h2><p>So from the prompt, we know we should look at HTTP(S) things. HTTP Command and Control beaconing is a thing.</p>
<ol>
<li>Look at the HTTP Objects: File -> Export Objects -> HTTP Objects</li>
<li>Notice the port is 8080</li>
</ol>
<p><code>MetaCTF{8080}</code></p>
<h1 id=the-searcher>The Searcher
<span>
<a href=#the-searcher><svg viewBox="0 0 28 23" height="100%" width="19" xmlns="http://www.w3.org/2000/svg"><path d="M10 13a5 5 0 007.54.54l3-3a5 5 0 00-7.07-7.07l-1.72 1.71" fill="none" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2"/><path d="M14 11a5 5 0 00-7.54-.54l-3 3a5 5 0 007.07 7.07l1.71-1.71" fill="none" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2"/></svg>
</a>
</span>
</h1><p>Alright analyst. We need your help with some investigative work as we dive deeper into one of the infections on our company&rsquo;s network. We&rsquo;ve taken a small packet capture that we know contains some C2 traffic. In order to give us some more leads for the investigation though, we&rsquo;d like to see if we can identify what C2 framework the attacker was using. This will give us some leads into potential host-based artifacts that might be left behind.</p>
<p>Please submit the name of the C2 Framework being used in the form of MetaCTF{c2frameworkname}</p>
<h2 id=solve-9>Solve
<span>
<a href=#solve-9><svg viewBox="0 0 28 23" height="100%" width="19" xmlns="http://www.w3.org/2000/svg"><path d="M10 13a5 5 0 007.54.54l3-3a5 5 0 00-7.07-7.07l-1.72 1.71" fill="none" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2"/><path d="M14 11a5 5 0 00-7.54-.54l-3 3a5 5 0 007.07 7.07l1.71-1.71" fill="none" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2"/></svg>
</a>
</span>
</h2><p>Looking at the pcap -> notice the user agent (this is a good way to identify C2 frameworks).</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python>GET <span style=color:#ff79c6>/</span>en<span style=color:#ff79c6>-</span>us<span style=color:#ff79c6>/</span>docs<span style=color:#ff79c6>.</span>html HTTP<span style=color:#ff79c6>/</span><span style=color:#bd93f9>1.1</span>
User<span style=color:#ff79c6>-</span>Agent: Mozilla<span style=color:#ff79c6>/</span><span style=color:#bd93f9>5.0</span> (Windows NT <span style=color:#bd93f9>6.1</span>) AppleWebKit<span style=color:#ff79c6>/</span><span style=color:#bd93f9>537.36</span> (KHTML, like Gecko) Chrome<span style=color:#ff79c6>/</span><span style=color:#bd93f9>41.0.2228.0</span> Safari<span style=color:#ff79c6>/</span><span style=color:#bd93f9>537.36</span>
Host: <span style=color:#bd93f9>52.44.115.131</span>:<span style=color:#bd93f9>8080</span>
Cookie: ASPSESSIONID<span style=color:#ff79c6>=</span>fc1060eace; SESSIONID<span style=color:#ff79c6>=</span><span style=color:#bd93f9>1552332971750</span>

HTTP<span style=color:#ff79c6>/</span><span style=color:#bd93f9>1.1</span> <span style=color:#bd93f9>200</span> OK
Date: Mon, <span style=color:#bd93f9>22</span> Nov <span style=color:#bd93f9>2021</span> <span style=color:#bd93f9>01</span>:<span style=color:#bd93f9>33</span>:<span style=color:#bd93f9>24</span> GMT
Content<span style=color:#ff79c6>-</span>Type: text<span style=color:#ff79c6>/</span>plain; charset<span style=color:#ff79c6>=</span>utf<span style=color:#ff79c6>-</span><span style=color:#bd93f9>8</span>
Server: Microsoft<span style=color:#ff79c6>-</span>IIS<span style=color:#ff79c6>/</span><span style=color:#bd93f9>7.5</span>
Transfer<span style=color:#ff79c6>-</span>Encoding: chunked
</code></pre></div><p>Google search on the SESSIONID: find <a href=https://github.com/sclow/covenant_mgmt/blob/main/config.yml.example>GitHub</a></p>
<p><code>MetaCTF{Covenant}</code></p>
</div>
<div class=post-info>
<div class="post-date dt-published">2021-12-03</div>
<a class="post-hidden-url u-url" href=https://murphe22.com/posts/metactf/>https://murphe22.com/posts/metactf/</a>
<a href=https://murphe22.com class="p-name p-author post-hidden-author h-card" rel=me>Emily Murphy</a>
<div class=post-taxonomies>
<ul class=post-categories>
<li><a href=https://murphe22.com/categories/writeups/>writeups</a></li>
</ul>
<ul class=post-tags>
<li><a href=https://murphe22.com/tags/ctfs/>#ctfs</a></li>
<li><a href=https://murphe22.com/tags/writeups/>#writeups</a></li>
</ul>
</div>
</div>
</article>
<div class="pagination post-pagination">
<div class="left pagination-item">
<a href=/posts/nsacodebreaker/>NSA Codebreakers 2021</a>
</div>
<div class="right pagination-item">
<a href=/posts/comptiacysa/>CompTIA CySA+</a>
</div>
</div>
</main>
<footer class=common-footer>
<div class=common-footer-bottom>
<div class=copyright>
<p>¬© Emily Murphy, 2022<br>
Powered by <a target=_blank rel="noopener noreferrer" href=https://gohugo.io/>Hugo</a>, theme <a target=_blank rel="noopener noreferrer" href=https://github.com/mitrichius/hugo-theme-anubis>Anubis</a>.<br>
</p>
</div>
<button class=theme-switcher>
Dark theme
</button>
<script>const STORAGE_KEY='user-color-scheme',defaultTheme="light";let currentTheme,switchButton,autoDefinedScheme=window.matchMedia('(prefers-color-scheme: dark)');const autoChangeScheme=a=>{currentTheme=a.matches?'dark':'light',document.documentElement.setAttribute('data-theme',currentTheme),changeButtonText()};document.addEventListener('DOMContentLoaded',function(){switchButton=document.querySelector('.theme-switcher'),currentTheme=detectCurrentScheme(),currentTheme=='dark'&&document.documentElement.setAttribute('data-theme','dark'),currentTheme=='auto'&&(autoChangeScheme(autoDefinedScheme),autoDefinedScheme.addListener(autoChangeScheme)),changeButtonText(),switchButton.addEventListener('click',switchTheme,!1)});function detectCurrentScheme(){return localStorage.getItem(STORAGE_KEY)?localStorage.getItem(STORAGE_KEY):defaultTheme?defaultTheme:window.matchMedia?window.matchMedia('(prefers-color-scheme: dark)').matches?'dark':'light':'light'}function changeButtonText(){switchButton.textContent=currentTheme=='dark'?"Light theme":"Dark theme"}function switchTheme(a){currentTheme=='dark'?(localStorage.setItem(STORAGE_KEY,'light'),document.documentElement.setAttribute('data-theme','light'),currentTheme='light'):(localStorage.setItem(STORAGE_KEY,'dark'),document.documentElement.setAttribute('data-theme','dark'),currentTheme='dark'),changeButtonText()}</script>
</div>
<p class="h-card vcard">
<a href=https://murphe22.com class="p-name u-url url fn" rel=me>Emily Murphy</a>
</p>
</footer>
</div>
</body>
</html>